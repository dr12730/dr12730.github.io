I"õ<!-- vim-markdown-toc GFM -->

<ul>
  <li><a href="#1-å‰è¨€">1 å‰è¨€</a>
    <ul>
      <li><a href="#11-æœ¬æ„æ¦‚è¦">1.1 æœ¬æ„æ¦‚è¦</a></li>
      <li><a href="#12-ç›®å½•">1.2 ç›®å½•</a></li>
    </ul>
  </li>
  <li><a href="#2-è¯»ä¹¦ç¬”è®°">2 è¯»ä¹¦ç¬”è®°</a>
    <ul>
      <li><a href="#21-æå‡æ–¹æ³•-adaboost">2.1 æå‡æ–¹æ³• AdaBoost</a>
        <ul>
          <li><a href="#211-åŸºæœ¬æ€è·¯">2.1.1 åŸºæœ¬æ€è·¯</a></li>
          <li><a href="#212-adaboost-ç®—æ³•">2.1.2 AdaBoost ç®—æ³•</a></li>
          <li><a href="#213-åº”ç”¨">2.1.3 åº”ç”¨</a></li>
          <li><a href="#213-ä»£ç å®æˆ˜">2.1.3 ä»£ç å®æˆ˜</a></li>
        </ul>
      </li>
      <li><a href="#22-adaboost-ç®—æ³•è®­ç»ƒè¯¯å·®åˆ†æ">2.2 AdaBoost ç®—æ³•è®­ç»ƒè¯¯å·®åˆ†æ</a>
        <ul>
          <li><a href="#221-adaboost-çš„è®­ç»ƒè¯¯å·®è¾¹ç•Œ">2.2.1 AdaBoost çš„è®­ç»ƒè¯¯å·®è¾¹ç•Œ</a></li>
        </ul>
      </li>
      <li><a href="#23-adaboost-ç®—æ³•çš„è§£é‡Š">2.3 AdaBoost ç®—æ³•çš„è§£é‡Š</a>
        <ul>
          <li><a href="#231-å‰å‘åˆ†æ­¥ç®—æ³•">2.3.1 å‰å‘åˆ†æ­¥ç®—æ³•</a>
            <ul>
              <li><a href="#ç®—æ³•">ç®—æ³•</a></li>
            </ul>
          </li>
          <li><a href="#232-å‰å‘åˆ†æ­¥ç®—æ³•ä¸-adaboost">2.3.2 å‰å‘åˆ†æ­¥ç®—æ³•ä¸ AdaBoost</a></li>
        </ul>
      </li>
      <li><a href="#3-ç¼–ç¨‹">3 ç¼–ç¨‹</a></li>
    </ul>
  </li>
</ul>

<!-- vim-markdown-toc -->

<h1 id="1-å‰è¨€">1 å‰è¨€</h1>

<h2 id="11-æœ¬æ„æ¦‚è¦">1.1 æœ¬æ„æ¦‚è¦</h2>

<ol>
  <li>
    <p><strong>æå‡æ–¹æ³•</strong>æ˜¯å°†å¼±å­¦ä¹ ç®—æ³•æå‡ä¸ºå¼ºå­¦ä¹ ç®—æ³•çš„ç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‚æå‡æ–¹æ³•é€šè¿‡åå¤ä¿®æ”¹è®­ç»ƒæ•°æ®æƒå€¼åˆ†å¸ƒï¼Œæ„å»ºä¸€ç³»åˆ—åŸºæœ¬åˆ†ç±»å™¨ï¼ˆå¼±åˆ†ç±»å™¨ï¼‰ï¼Œç„¶åå°†è¿™äº›å¼±åˆ†ç±»å™¨çº¿æ€§ç»„åˆæˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨ã€‚</p>
  </li>
  <li>
    <p>AdaBoost æ¨¡å‹æ˜¯å¼±åˆ†ç±»å™¨çš„çº¿æ€§ç»„åˆï¼š</p>

    <script type="math/tex; mode=display">f(x) = \sum\limits_{m=1}^M \alpha_m G_m(x)</script>
  </li>
  <li>
    <p>AdaBoost æ¯æ¬¡è¿­ä»£æé«˜å‰ä¸€è½®åˆ†ç±»å™¨é”™è¯¯åˆ†ç±»æ•°æ®çš„æƒå€¼ï¼Œé™ä½æ­£ç¡®åˆ†ç±»çš„æ•°æ®æƒå€¼ã€‚æœ€åï¼Œå°†åŸºæœ¬åˆ†ç±»å™¨çº¿æ€§ç»„åˆï¼Œå¯¹äºåˆ†ç±»è¯¯å·®ç‡å°çš„åŸºæœ¬åˆ†ç±»å™¨ç»™äºˆå¤§çš„æƒå€¼ï¼Œç»™åˆ†ç±»è¯¯å·®ç‡å¤§çš„åŸºæœ¬åˆ†ç±»å™¨ä»¥å°çš„æƒå€¼</p>
  </li>
  <li>
    <p>AdaBoost æ¯æ¬¡è¿­ä»£å¯ä»¥å‡å°‘å®ƒåœ¨è®­ç»ƒæ•°æ®é›†ä¸Šçš„åˆ†ç±»è¯¯å·®ç‡</p>
  </li>
  <li>
    <p>AdaBoost æ˜¯å‰èº«åˆ†æ­¥ç®—æ³•çš„ä¸€ä¸ªå®ç°ã€‚æ¨¡å‹æ˜¯åŠ æ³•æ¨¡å‹ï¼ŒæŸå¤±å‡½æ•°æ˜¯æŒ‡æ•°æŸå¤±ï¼Œç®—æ³•æ˜¯å‰èº«åˆ†æ­¥ç®—æ³•ã€‚åœ¨æ¯æ­¥ä¸­æå°åŒ–æŸå¤±å‡½æ•° $(\beta_m, \gamma_m) = arg \min\limits_{\beta, \gamma} \sum\limits_{i=1}^N L(y_i, f_{m-1}(x_i) + \beta b(x_i; \gamma))$ å¾—åˆ°å‚æ•° $\beta_m, \gamma_m$</p>
  </li>
  <li>
    <p>æå‡æ ‘æ˜¯ç»Ÿè®¡å­¦ä¹ ä¸­æœ€æœ‰æ•ˆçš„æ–¹æ³•ä¹‹ä¸€ã€‚ä»¥åˆ†ç±»æ ‘å’Œå›å½’æ ‘ä¸ºåŸºæœ¬åˆ†ç±»å™¨</p>
  </li>
</ol>

<h2 id="12-ç›®å½•">1.2 ç›®å½•</h2>

<ol>
  <li>æå‡æ–¹æ³•<br />
1.1 æå‡æ–¹æ³•çš„åŸºæœ¬æ€è·¯<br />
1.2 AdaBoost ç®—æ³•<br />
1.3 AdaBoost çš„ä¾‹å­</li>
  <li>AdaBoost ç®—æ³•çš„è®­ç»ƒè¯¯å·®åˆ†æ</li>
  <li>AdaBoost ç®—æ³•çš„è§£é‡Š<br />
3.1 å‰å‘åˆ†æ­¥ç®—æ³•<br />
3.2 å‰å‘åˆ†æ­¥ç®—æ³•ä¸ AdaBoost</li>
  <li>æå‡æ ‘<br />
4.1 æå‡æ ‘æ¨¡å‹<br />
4.2 æå‡æ ‘ç®—æ³•<br />
4.3 æ¢¯åº¦æå‡</li>
</ol>

<hr />

<h1 id="2-è¯»ä¹¦ç¬”è®°">2 è¯»ä¹¦ç¬”è®°</h1>

<p>æå‡æ–¹æ³•æ˜¯ä¸€ç§å¸¸è§çš„ç»Ÿè®¡å­¦ä¹ æ–¹æ³•ï¼Œå®ƒçš„è¿‡ç¨‹æ˜¯é€šè¿‡æ”¹å˜è®­ç»ƒæ ·æœ¬çš„æƒé‡ï¼Œè®­ç»ƒå¤šä¸ªåˆ†ç±»å™¨ï¼Œæœ€åæŠŠè¿™äº›åˆ†ç±»å™¨çº¿æ€§ç»„åˆèµ·æ¥ï¼Œå¾—åˆ°æ€§èƒ½æ›´é«˜çš„åˆ†ç±»å™¨ã€‚</p>

<h2 id="21-æå‡æ–¹æ³•-adaboost">2.1 æå‡æ–¹æ³• AdaBoost</h2>

<h3 id="211-åŸºæœ¬æ€è·¯">2.1.1 åŸºæœ¬æ€è·¯</h3>

<ul>
  <li>
    <p>å¯¹äºå¤æ‚ä»»åŠ¡ï¼Œä¸‰ä¸ªè‡­çš®åŒ é¡¶ä¸ªè¯¸è‘›äº®ã€‚</p>
  </li>
  <li>
    <p><strong>å¼ºå¯å­¦ä¹ </strong>æ˜¯æŒ‡å¯¹äºä¸€ä¸ªç±»åˆ«ï¼ˆæˆ–æ¦‚å¿µï¼‰å¦‚æœå­˜åœ¨ä¸€ä¸ªå¤šé¡¹å¼çš„å­¦ä¹ ç®—æ³•èƒ½å¤Ÿæ‹Ÿåˆå®ƒï¼Œå¹¶ä¸”æ­£ç¡®ç‡é«˜</p>
  </li>
  <li>
    <p><strong>å¼±å¯å­¦ä¹ </strong>æ˜¯æŒ‡å¯¹äºä¸€ä¸ªç±»åˆ«ï¼Œç®—æ³•å­¦ä¹ çš„æ­£ç¡®ç‡ä»…æ¯”éšæœºçŒœæµ‹ç•¥å¥½</p>
  </li>
  <li>
    <p><strong>æå‡æ–¹æ³•</strong>æ˜¯æ”¹å˜è®­ç»ƒæ•°æ®çš„æ¦‚ç‡åˆ†å¸ƒï¼ˆè®­ç»ƒæ•°æ®çš„æƒå€¼åˆ†å¸ƒï¼‰ï¼Œè°ƒç”¨å¼±å­¦ä¹ ç®—æ³•å­¦ä¹ ä¸€ç³»åˆ—å¼±åˆ†ç±»å™¨</p>
  </li>
</ul>

<p>æå‡æ–¹æ³•çš„ç†è®ºåŸºç¡€æ¥æºäº<strong>å¼ºå¯å­¦ä¹ ç­‰ä»·äºå¼±å¯å­¦ä¹ </strong>ï¼Œè€Œå‘ç°å¼±å¯å­¦ä¹ ç®—æ³•æ˜¯éå¸¸å®¹æ˜“çš„ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•æŠŠå¼±å¯å­¦ä¹ ç®—æ³•æå‡åˆ°å¼ºå¯å­¦ä¹ ç®—æ³•å‘¢ï¼Ÿæå‡æ–¹æ³•é‡‡ç”¨çš„æ˜¯ä»å¼±å¯å­¦ä¹ ç®—æ³•å‡ºå‘ï¼Œåå¤å­¦ä¹ ï¼Œå¾—åˆ°ä¸€ç³»åˆ—çš„å¼±åˆ†ç±»å™¨ï¼ˆåŸºç¡€åˆ†ç±»å™¨ï¼‰ï¼Œç„¶åç»„åˆå®ƒä»¬ï¼Œæ„æˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨ã€‚</p>

<h3 id="212-adaboost-ç®—æ³•">2.1.2 AdaBoost ç®—æ³•</h3>

<ul>
  <li>
    <p>è¾“å…¥ï¼š</p>

    <ul>
      <li>æ•°æ®é›† $T = {(x_1, y_1), (x_2, y_2), â€¦, (x_N, y_N)}$</li>
      <li>å¼±å­¦ä¹ ç®—æ³•</li>
    </ul>
  </li>
  <li>
    <p>è¾“å‡º</p>

    <ul>
      <li>æœ€ç»ˆåˆ†ç±»å™¨ $G(x)$</li>
    </ul>
  </li>
  <li>
    <p>æµç¨‹</p>

    <ol>
      <li>
        <p>åˆå§‹åŒ–è®­ç»ƒæ•°æ®é›†çš„æƒå€¼åˆ†å¸ƒ</p>

        <p>$D_1 = (w_{11}, â€¦, w_{1i}, â€¦, w_{1N})$ï¼Œå…¶ä¸­ $w_{1i} = \dfrac{1}{N}, i = 1, 2, â€¦, N$</p>
      </li>
      <li>
        <p>å¯¹äº $m = 1, 2, â€¦., M$ çš„æ¯ä¸€æ¬¡è¿­ä»£ï¼ŒAdaBoost å­¦ä¹ ä¸€ä¸ªåŸºæœ¬åˆ†ç±»å™¨ $G_m(x)$</p>

        <ul>
          <li>
            <p>ç”¨æƒå€¼åˆ†å¸ƒ $D_m$ çš„è®­ç»ƒæ•°æ®é›†å­¦ä¹ ï¼Œå¾—åˆ°åŸºæœ¬åˆ†ç±»å™¨ $G_m(x): X \to {-1, +1}$</p>
          </li>
          <li>
            <p>è®¡ç®— $G_m(x)$ åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šçš„ <strong>åŠ æƒåˆ†ç±»è¯¯å·®ç‡</strong></p>

            <script type="math/tex; mode=display">e_m = \sum\limits_{i=1}^{N} w_{mi} I(G_m(x_i) \neq y_i)</script>

            <p>å…¶ä¸­ï¼š$w_{m,i}$ æ˜¯ç¬¬ i ä¸ªæ ·æœ¬çš„æƒå€¼</p>
          </li>
          <li>
            <p>è®¡ç®— $G_m(x)$ çš„ç³»æ•° $\alpha_m = \dfrac{1}{2} \ln \dfrac{1 - e_m}{e_m}$</p>
          </li>
          <li>
            <p>æ›´æ–°è®­ç»ƒæ•°æ®é›†çš„æƒå€¼åˆ†å¸ƒ</p>

            <script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}D_{m+1} &= (w_{m+1, 1}, ..., w_{m+1, i, }..., w_{m+1, N}) \\ w_{m+1, i} &= \dfrac{w_{mi}}{Z_m} e^{-\alpha_m y_i G_m(x_i)} \\ Z_m &= \sum\limits_{i=1}^{N} w_{mi} e^{-\alpha_m y_i G_m(x_i)} \end{aligned} %]]></script>
          </li>
          <li>
            <p>æ„å»ºåŸºæœ¬åˆ†ç±»å™¨çš„çº¿æ€§ç»„åˆ $f(x) = \sum\limits_{m=1}^N \alpha_m G_m(x)$ï¼Œå¾—åˆ°æœ€ç»ˆåˆ†ç±»å™¨ï¼š</p>

            <script type="math/tex; mode=display">G(x) = sign \left( f(x) \right) = sign \left( \sum\limits_{m=1}^N \alpha_m G_m(x)\right)</script>
          </li>
        </ul>
      </li>
    </ol>
  </li>
</ul>

<h3 id="213-åº”ç”¨">2.1.3 åº”ç”¨</h3>

<p>ç»™å®šè®­ç»ƒé›†æ•°æ®å¦‚ä¸‹ï¼Œç”¨ AdaBoost ç®—æ³•å­¦ä¹ ä¸€ä¸ªå¼ºåˆ†ç±»å™¨ï¼š</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">åºå·</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">x</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
    <tr>
      <td style="text-align: center">y</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>-1</td>
    </tr>
  </tbody>
</table>

<ol>
  <li>
    <p>ç»™æ¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬ä¸€ä¸ªæƒå€¼</p>

    <script type="math/tex; mode=display">D_1 = (w_{1,1}, \dots, w_{1, i}, \dots, w_{1, M})</script>

    <p>å…¶ä¸­ $w_{1, i} = \dfrac{1}{N} = \dfrac{1}{10}$</p>
  </li>
  <li>
    <p>å¯¹äºç¬¬ä¸€æ¬¡è¿­ä»£ï¼Œäº§å‡ºç¬¬ä¸€ä¸ªåŸºç¡€åˆ†ç±»å™¨ $G_1(x)$</p>

    <ul>
      <li>
        <p>é¦–å…ˆï¼Œå®šä¹‰å¼±åˆ†ç±»å™¨ $G(x)$ ä¸ºå¦‚ä¸‹å½¢å¼ï¼š</p>

        <p>$G(x) = \left{\begin{aligned} 1, &amp;&amp; x \le v\ -1, &amp;&amp; x &gt; v\end{aligned}\right.$ æˆ– $G(x) = \left{\begin{aligned} 1, &amp;&amp; x &gt; v\ -1, &amp;&amp; x \le v\end{aligned}\right.$</p>
      </li>
      <li>
        <p>ç„¶åï¼Œ$v = [0.5, 1.5, 2.5, \dots, 10.5]$ï¼Œçœ‹å“ªä¸ª $G(x)$ å’Œ v çš„ç»„åˆå¾—åˆ°çš„è¯¯å·®ç‡æœ€å°ã€‚è¿™é‡Œéå†å¾—åˆ°</p>

        <script type="math/tex; mode=display">% <![CDATA[
G(x) = \left\{\begin{aligned} 1, && x \le 2.5\\ -1, && x > 2.5\end{aligned}\right. %]]></script>

        <p>åˆ†ç±»è¯¯å·®ç‡æœ€å°ï¼Œè€Œä¸” $e_1 = 0.3$</p>
      </li>
      <li>
        <p>è®¡ç®—è¿™ä¸ªåŸºæœ¬åˆ†ç±»å™¨  $G_1(x)$ çš„ç³»æ•°</p>

        <script type="math/tex; mode=display">\alpha_1 = \dfrac{1}{2} \log \dfrac{1 - e_1}{e_1} = 0.4236</script>
      </li>
      <li>
        <p>æ›´æ–°è®­ç»ƒæ•°æ®é›†çš„æƒå€¼åˆ†å¸ƒ</p>

        <script type="math/tex; mode=display">D_1 = (w_{2,1}, \dots, w_{2,i}, \dots, w_{2, M})</script>

        <p>å…¶ä¸­ $w_{2,i} = \dfrac{w_{1,i}}{Z_1} e^{-\alpha_i y_i G_1(x)}$</p>

        <p>è®¡ç®—å¾—åˆ° $D_1 = (0.07143, 0.07143, \dots)$</p>
      </li>
      <li>
        <p>é‚£ä¹ˆï¼Œ$f_1(x) = 0.4236 G_1(x)$ï¼Œåˆ†ç±»å™¨ä¸º $sign[f_1(x)]$</p>
      </li>
    </ul>
  </li>
  <li>
    <p>å¯¹äºç¬¬äºŒæ¬¡è¿­ä»£ï¼Œäº§å‡ºç¬¬äºŒä¸ªåŸºç¡€åˆ†ç±»å™¨</p>

    <ul>
      <li>
        <p>åœ¨æƒå€¼åˆ†å¸ƒä¸º $D_2$ çš„è®­ç»ƒé›†ä¸Šï¼Œé˜ˆå€¼ä¸º $v = 8.5$ æ˜¯è¯¯å·®ç‡æœ€ä¼˜ï¼Œæ‰€ä»¥åŸºæœ¬åˆ†ç±»å™¨ä¸º</p>

        <script type="math/tex; mode=display">% <![CDATA[
G_2(x) = \left\{\begin{aligned} 1, && x \le 8.5\\ -1, && x > 8.5\end{aligned}\right. %]]></script>
      </li>
      <li>
        <p>$G_2(x)$ åœ¨è®­ç»ƒé›†ä¸Šçš„åŠ æƒè¯¯å·®ç‡ä¸º $e_2 = 0.2143$</p>
      </li>
      <li>
        <p>è®¡ç®—è¿™ä¸ªåŸºæœ¬åˆ†ç±»å™¨  $G_2(x)$ çš„ç³»æ•°</p>

        <script type="math/tex; mode=display">\alpha_2 = \dfrac{1}{2} \log \dfrac{1 - e_2}{e_2} = 0.6496</script>
      </li>
      <li>
        <p>æ›´æ–°è®­ç»ƒæ•°æ®é›†çš„æƒå€¼åˆ†å¸ƒ $D_3$</p>

        <script type="math/tex; mode=display">D_3 = (w_{3,1}, \dots, w_{3,i}, \dots, w_{3, M})</script>
      </li>
      <li>
        <p>é‚£ä¹ˆï¼Œ$f_2(x) = 0.4236 G_1(x) + 0.6496 G_2(x)$ï¼Œåˆ†ç±»å™¨ä¸º $sign[f_2(x)]$</p>
      </li>
    </ul>
  </li>
  <li>
    <p>$m = 3, 4, \dots$ ä»¥æ­¤ç±»æ¨</p>

    <p>AdaBoost çš„è®­ç»ƒè¯¯å·®æ˜¯ä»¥æŒ‡æ•°çº§ä¸‹é™çš„</p>
  </li>
</ol>

<h3 id="213-ä»£ç å®æˆ˜">2.1.3 ä»£ç å®æˆ˜</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">DATA_FILE</span> <span class="o">=</span> <span class="s">'./Machine-Learning/AdaBoost_Project2/horseColicTraining2.txt'</span>
<span class="n">TEST_FILE</span> <span class="o">=</span> <span class="s">'./Machine-Learning/AdaBoost_Project2/horseColicTest2.txt'</span>

<span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="s">'''
    ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®å’Œæ ‡ç­¾ 
    '''</span>
    <span class="n">dirpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">fr</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fr</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
        <span class="c1">#nftrs = len(lines[0]) - 1
</span>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="nb">float</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="nb">float</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">stumpClassify</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dimen</span><span class="p">,</span> <span class="n">thresh_val</span><span class="p">,</span> <span class="n">thresh_ineq</span><span class="p">):</span>
    <span class="s">'''
    :data: è®­ç»ƒæ•°æ®
    :dimen: ç‰¹å¾
    :thresh_val: é˜ˆå€¼
    :thresh_ineq: ç¬¦å·

    :ret: åˆ†ç±»ç»“æœ
    '''</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">thresh_ineq</span> <span class="o">==</span> <span class="s">'lt'</span><span class="p">:</span>
        <span class="n">ret</span><span class="p">[</span><span class="n">data</span><span class="p">[:,</span> <span class="n">dimen</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">thresh_val</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ret</span><span class="p">[</span><span class="n">data</span><span class="p">[:,</span> <span class="n">dimen</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">thresh_val</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">ret</span>


<span class="k">def</span> <span class="nf">buildStump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
    <span class="s">'''
    æ‰¾åˆ°æ•°æ®é›†ä¸Šçš„æœ€ä½³å•å±‚å†³ç­–æ ‘

    Parameters:
        data: è®­ç»ƒé›†æ•°æ®
        labels: æ ‡ç­¾
        D: æ ·æœ¬æƒé‡

    Returns:
        bestStump: æœ€ä½³å•å±‚å†³ç­–æ ‘ä¿¡æ¯
        minError: æœ€å°è¯¯å·®
        bestClasEst: æœ€ä½³çš„åˆ†ç±»ç»“æœ

    ------------------------------------------------
    1. å¯¹äºè®­ç»ƒæ•°æ®é›†ä¸­çš„æ¯ä¸€ä¸ªç‰¹å¾ï¼š
        1.1 å¯¹äºå¤§äºå’Œå°äºï¼ˆç­‰äºï¼‰ä¸¤ç§æƒ…å†µ:
            1.1.1 è®¡ç®—åˆ†ç±»çš„é˜ˆå€¼
            1.1.2 è®¡ç®—åˆ†ç±»ç»“æœ
            1.1.3 è®¡ç®—åŠ æƒè¯¯å·®ç‡
            1.1.4 è®¡ç®—æœ€å°è¯¯å·®ç‡åŠå¯¹åº”çš„åŸºæœ¬åˆ†ç±»å™¨
    ------------------------------------------------
    '''</span>
    <span class="c1"># m=5, n=2
</span>    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">numSteps</span> <span class="o">=</span> <span class="mf">10.0</span>
    <span class="n">bestStump</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># (5, 1)å…¨é›¶åˆ—çŸ©é˜µ
</span>    <span class="n">bestClasEst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="c1"># æœ€å°è¯¯å·®åˆå§‹åŒ–ä¸ºæ­£æ— ç©·å¤§inf
</span>    <span class="n">minError</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">'inf'</span><span class="p">)</span>
    <span class="c1"># éå†æ‰€æœ‰ç‰¹å¾
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="c1"># æ‰¾åˆ°(æ¯åˆ—)ç‰¹å¾ä¸­çš„æœ€å°å€¼å’Œæœ€å¤§å€¼
</span>        <span class="n">rangeMin</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="nb">min</span><span class="p">()</span>
        <span class="n">rangeMax</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="nb">max</span><span class="p">()</span>
        <span class="c1"># è®¡ç®—æ­¥é•¿
</span>        <span class="n">stepSize</span> <span class="o">=</span> <span class="p">(</span><span class="n">rangeMax</span> <span class="o">-</span> <span class="n">rangeMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">numSteps</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">numSteps</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># å¤§äºå’Œå°äºçš„æƒ…å†µå‡éå†ï¼Œlt:Less than  gt:greater than
</span>            <span class="k">for</span> <span class="n">inequal</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'lt'</span><span class="p">,</span> <span class="s">'gt'</span><span class="p">]:</span>
                <span class="c1"># è®¡ç®—é˜ˆå€¼
</span>                <span class="n">threshVal</span> <span class="o">=</span> <span class="p">(</span><span class="n">rangeMin</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">stepSize</span><span class="p">)</span>
                <span class="c1"># è®¡ç®—åˆ†ç±»ç»“æœ
</span>                <span class="n">predictedVals</span> <span class="o">=</span> <span class="n">stumpClassify</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">threshVal</span><span class="p">,</span> <span class="n">inequal</span><span class="p">)</span>
                <span class="c1"># åˆå§‹åŒ–è¯¯å·®çŸ©é˜µ
</span>                <span class="n">errArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                <span class="c1"># åˆ†ç±»æ­£ç¡®çš„ï¼Œèµ‹å€¼ä¸º0
</span>                <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">errArr</span><span class="p">[</span><span class="n">predictedVals</span> <span class="o">==</span> <span class="n">labels</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="c1"># è®¡ç®—è¯¯å·®
</span>                <span class="n">weightedError</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">errArr</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: </span><span class="si">%</span><span class="s">d, é˜ˆå€¼: </span><span class="si">%.2</span><span class="s">f, ç¬¦å·: </span><span class="si">%</span><span class="s">s, åŠ æƒè¯¯å·®: </span><span class="si">%.3</span><span class="s">f"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">threshVal</span><span class="p">,</span> <span class="n">inequal</span><span class="p">,</span> <span class="n">weightedError</span><span class="p">))</span>
                <span class="c1"># æ‰¾åˆ°è¯¯å·®æœ€å°çš„åˆ†ç±»æ–¹å¼
</span>                <span class="k">if</span> <span class="n">weightedError</span> <span class="o">&lt;</span> <span class="n">minError</span><span class="p">:</span>
                    <span class="n">minError</span> <span class="o">=</span> <span class="n">weightedError</span>
                    <span class="n">bestClasEst</span> <span class="o">=</span> <span class="n">predictedVals</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">bestStump</span><span class="p">[</span><span class="s">'dim'</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="n">bestStump</span><span class="p">[</span><span class="s">'thresh'</span><span class="p">]</span> <span class="o">=</span> <span class="n">threshVal</span>
                    <span class="n">bestStump</span><span class="p">[</span><span class="s">'ineq'</span><span class="p">]</span> <span class="o">=</span> <span class="n">inequal</span>
    <span class="k">return</span> <span class="n">bestStump</span><span class="p">,</span> <span class="n">minError</span><span class="p">,</span> <span class="n">bestClasEst</span>


<span class="k">def</span> <span class="nf">adaClassify</span><span class="p">(</span><span class="n">datToClass</span><span class="p">,</span> <span class="n">classifierArr</span><span class="p">):</span>
    <span class="s">'''
    å‡½æ•°è¯´æ˜ï¼šAdaBooståˆ†ç±»å‡½æ•°
    
    Parameters:
        datToClass - å¾…åˆ†ç±»æ ·ä¾‹
        classifierArr - è®­ç»ƒå¥½çš„åˆ†ç±»å™¨
        
    Returns:
        åˆ†ç±»ç»“æœ
    '''</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">datToClass</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">aggClassEst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classifierArr</span><span class="p">)):</span>
        <span class="c1"># éå†æ‰€æœ‰åˆ†ç±»å™¨è¿›è¡Œåˆ†ç±»
</span>        <span class="n">classEst</span> <span class="o">=</span> <span class="n">stumpClassify</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">classifierArr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'dim'</span><span class="p">],</span> <span class="n">classifierArr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'thresh'</span><span class="p">],</span> <span class="n">classifierArr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'ineq'</span><span class="p">])</span>
        <span class="n">aggClassEst</span> <span class="o">+=</span> <span class="n">classifierArr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'alpha'</span><span class="p">]</span> <span class="o">*</span> <span class="n">classEst</span>
        <span class="c1"># print(aggClassEst)
</span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">aggClassEst</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">adaBoostTrainDS</span><span class="p">(</span><span class="n">dataArr</span><span class="p">,</span> <span class="n">classLabels</span><span class="p">,</span> <span class="n">numIt</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="s">'''
    å‡½æ•°è¯´æ˜ï¼šä½¿ç”¨AdaBoostè¿›è¡Œä¼˜åŒ–
    
    Parameters:
        dataArr - æ•°æ®çŸ©é˜µ
        classLabels - æ•°æ®æ ‡ç­¾
        numIt - æœ€å¤§è¿­ä»£æ¬¡æ•°
        
    Returns:
        weakClassArr - å­˜å‚¨å•å±‚å†³ç­–æ ‘çš„list
        aggClassEsc - è®­ç»ƒçš„label
    '''</span>
    <span class="n">weakClassArr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># è·å–æ•°æ®é›†çš„è¡Œæ•°
</span>    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dataArr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># æ ·æœ¬æƒé‡ï¼Œæ¯ä¸ªæ ·æœ¬æƒé‡ç›¸ç­‰ï¼Œå³1/n
</span>    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">m</span>
    <span class="c1"># åˆå§‹åŒ–ä¸ºå…¨é›¶åˆ—
</span>    <span class="n">aggClassEst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="c1"># è¿­ä»£
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numIt</span><span class="p">):</span>
        <span class="c1"># æ„å»ºå•å±‚å†³ç­–æ ‘
</span>        <span class="n">bestStump</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">classEst</span> <span class="o">=</span> <span class="n">buildStump</span><span class="p">(</span><span class="n">dataArr</span><span class="p">,</span> <span class="n">classLabels</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
        <span class="c1"># print("D:", D.T)
</span>        <span class="c1"># è®¡ç®—å¼±å­¦ä¹ ç®—æ³•æƒé‡alphaï¼Œä½¿errorä¸ç­‰äº0ï¼Œå› ä¸ºåˆ†æ¯ä¸èƒ½ä¸º0
</span>        <span class="n">alpha</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">error</span><span class="p">)</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="mf">1e-16</span><span class="p">)))</span>
        <span class="c1"># å­˜å‚¨å¼±å­¦ä¹ ç®—æ³•æƒé‡
</span>        <span class="n">bestStump</span><span class="p">[</span><span class="s">'alpha'</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="c1"># å­˜å‚¨å•å±‚å†³ç­–æ ‘
</span>        <span class="n">weakClassArr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bestStump</span><span class="p">)</span>
        <span class="c1"># æ‰“å°æœ€ä½³åˆ†ç±»ç»“æœ
</span>        <span class="c1"># print("classEst: ", classEst.T)
</span>        <span class="c1"># è®¡ç®—eçš„æŒ‡æ•°é¡¹
</span>        <span class="n">expon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">classLabels</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">classEst</span><span class="p">)</span>
        <span class="c1"># è®¡ç®—é€’æ¨å…¬å¼çš„åˆ†å­
</span>        <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">expon</span><span class="p">))</span>
        <span class="c1"># æ ¹æ®æ ·æœ¬æƒé‡å…¬å¼ï¼Œæ›´æ–°æ ·æœ¬æƒé‡
</span>        <span class="n">D</span> <span class="o">=</span> <span class="n">D</span> <span class="o">/</span> <span class="n">D</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
        <span class="c1"># è®¡ç®—AdaBoostè¯¯å·®ï¼Œå½“è¯¯å·®ä¸º0çš„æ—¶å€™ï¼Œé€€å‡ºå¾ªç¯
</span>        <span class="c1"># ä»¥ä¸‹ä¸ºé”™è¯¯ç‡ç´¯è®¡è®¡ç®—
</span>        <span class="n">aggClassEst</span> <span class="o">+=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">classEst</span>
        <span class="c1"># print("aggClassEst: ", aggClassEst.T)
</span>        <span class="c1"># è®¡ç®—è¯¯å·®
</span>        <span class="n">aggErrors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">aggClassEst</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">classLabels</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">errorRate</span> <span class="o">=</span> <span class="n">aggErrors</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">m</span>
        <span class="c1"># print("total error:", errorRate)
</span>        <span class="k">if</span> <span class="n">errorRate</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="c1"># è¯¯å·®ä¸º0é€€å‡ºå¾ªç¯
</span>            <span class="k">break</span>
    <span class="k">return</span> <span class="n">weakClassArr</span><span class="p">,</span> <span class="n">aggClassEst</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">dataArr</span><span class="p">,</span> <span class="n">LabelArr</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">DATA_FILE</span><span class="p">)</span>
    <span class="n">weakClassArr</span><span class="p">,</span> <span class="n">aggClassEst</span> <span class="o">=</span> <span class="n">adaBoostTrainDS</span><span class="p">(</span><span class="n">dataArr</span><span class="p">,</span> <span class="n">LabelArr</span><span class="p">)</span>
    <span class="n">testArr</span><span class="p">,</span> <span class="n">testLabelArr</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">TEST_FILE</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">weakClassArr</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">adaClassify</span><span class="p">(</span><span class="n">dataArr</span><span class="p">,</span> <span class="n">weakClassArr</span><span class="p">)</span>
    <span class="n">errArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">dataArr</span><span class="p">),</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'è®­ç»ƒé›†çš„é”™è¯¯ç‡:</span><span class="si">%.3</span><span class="s">f</span><span class="si">%%</span><span class="s">'</span> <span class="o">%</span> <span class="nb">float</span><span class="p">(</span><span class="n">errArr</span><span class="p">[</span><span class="n">predictions</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">LabelArr</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">]</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataArr</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">adaClassify</span><span class="p">(</span><span class="n">testArr</span><span class="p">,</span> <span class="n">weakClassArr</span><span class="p">)</span>
    <span class="n">errArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">testArr</span><span class="p">),</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'æµ‹è¯•é›†çš„é”™è¯¯ç‡:</span><span class="si">%.3</span><span class="s">f</span><span class="si">%%</span><span class="s">'</span> <span class="o">%</span> <span class="nb">float</span><span class="p">(</span><span class="n">errArr</span><span class="p">[</span><span class="n">predictions</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">testLabelArr</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">]</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">testArr</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
</code></pre></div></div>
<p>è¿è¡Œç»“æœï¼š</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 0.90, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.502
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 0.90, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.498
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.00, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.497
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.00, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.503
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.10, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.497
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.10, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.503
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.20, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.497
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.20, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.503
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.30, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.497
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.30, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.503
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.40, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.497
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.40, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.503
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.50, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.497
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.50, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.503
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.60, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.497
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.60, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.503
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.70, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.497
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.70, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.503
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.80, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.497
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.80, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.503
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.90, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.497
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 1.90, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.503
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 2.00, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.498
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 0, é˜ˆå€¼: 2.00, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.502
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 1, é˜ˆå€¼: 0.20, ç¬¦å·: lt, åŠ æƒè¯¯å·®: 0.502
åŸºæœ¬åˆ†ç±»å™¨ ç‰¹å¾: 1, é˜ˆå€¼: 0.20, ç¬¦å·: gt, åŠ æƒè¯¯å·®: 0.498
...

è®­ç»ƒé›†çš„é”™è¯¯ç‡:18.729%
æµ‹è¯•é›†çš„é”™è¯¯ç‡:19.403%
</code></pre></div></div>

<h2 id="22-adaboost-ç®—æ³•è®­ç»ƒè¯¯å·®åˆ†æ">2.2 AdaBoost ç®—æ³•è®­ç»ƒè¯¯å·®åˆ†æ</h2>

<h3 id="221-adaboost-çš„è®­ç»ƒè¯¯å·®è¾¹ç•Œ">2.2.1 AdaBoost çš„è®­ç»ƒè¯¯å·®è¾¹ç•Œ</h3>

<p><strong>å®šç† 1</strong> AdaBoost ç®—æ³•æœ€ç»ˆåˆ†ç±»å™¨çš„è®­ç»ƒè¯¯å·®ç•Œä¸ºï¼š</p>

<script type="math/tex; mode=display">\dfrac{1}{N} \sum\limits_{i=1}^N I\bigg( G(x_i) \neq yi \bigg) \le \dfrac{1}{N} \sum\limits_i \exp\bigg(-y_i f(x_i)\bigg) = \prod_m Z_m</script>

<p><strong>å®šç† 2</strong> AdaBoost äºŒåˆ†ç±»é—®é¢˜çš„è®­ç»ƒè¯¯å·®è¾¹ç•Œ</p>

<script type="math/tex; mode=display">\prod_{m=1}^M Z_m = \prod_{m=1}^M 2 \sqrt{e_m(1-e_m)} = \prod_{m=1}^M \sqrt{1-4\gamma_m^2} \le \exp \left( -2 \sum\limits_{m=1}^M \gamma^2 \right)</script>

<p>è¿™é‡Œï¼Œ$\gamma_m = \dfrac{1}{2} - e_m$</p>

<h2 id="23-adaboost-ç®—æ³•çš„è§£é‡Š">2.3 AdaBoost ç®—æ³•çš„è§£é‡Š</h2>

<p>ä»å‰å‘åˆ†æ­¥ç®—æ³•çš„è§’åº¦ç†è§£ AdaBoost ç®—æ³•</p>

<h3 id="231-å‰å‘åˆ†æ­¥ç®—æ³•">2.3.1 å‰å‘åˆ†æ­¥ç®—æ³•</h3>

<p><strong>æ€æƒ³ï¼š</strong></p>

<p>ä»å‰å‘åï¼Œæ¯ä¸€æ­¥åªå­¦ä¹ ä¸€ä¸ªåŸºå‡½æ•°åŠå…¶ç³»æ•°ï¼Œé€æ­¥é€¼è¿‘ä¼˜åŒ–ç›®æ ‡ï¼Œå°±å¯ä»¥ç®€åŒ–ä¼˜åŒ–çš„å¤æ‚åº¦</p>

<h4 id="ç®—æ³•">ç®—æ³•</h4>

<ul>
  <li>
    <p>è¾“å…¥</p>

    <ul>
      <li>è®­ç»ƒæ•°æ®é›† $T = {(x_1, y_1), (x_2, y_2), â€¦, (x_N, y_N) }$</li>
      <li>æŸå¤±å‡½æ•° $L(y, f(x))$</li>
      <li>åŸºå‡½æ•°é›† ${ b(x; \gamma) }$</li>
    </ul>
  </li>
  <li>
    <p>è¾“å‡º</p>

    <ul>
      <li>åŠ æ³•æ¨¡å‹ $f(x) = \sum\limits_{m=1}^M \beta_m b(x; \gamma)$</li>
    </ul>
  </li>
  <li>
    <p>æµç¨‹</p>

    <ol>
      <li>
        <p>åˆå§‹åŒ– $f_0(x) = 0$</p>
      </li>
      <li>
        <p>å¯¹ $m = 1, 2, â€¦, M$</p>

        <ul>
          <li>
            <p>æå°åŒ–æŸå¤±å‡½æ•°å¾—åˆ°å‚æ•° $\beta_m, \gamma_m$</p>

            <script type="math/tex; mode=display">(\beta_m, \gamma_m) = \mathop{\arg\min}\limits_{\beta, \gamma} L\bigg( y_i, f_{m-1}(x_i) + \beta b(x; \gamma) \bigg)</script>
          </li>
          <li>
            <p>æ›´æ–°</p>

            <script type="math/tex; mode=display">f_m(x) = f_{m-1}(x) + \beta_m b(x; \gamma_m)</script>
          </li>
        </ul>
      </li>
      <li>
        <p>å¾—åˆ°åŠ æ³•æ¨¡å‹</p>

        <script type="math/tex; mode=display">f(x) = \sum\limits_{m=1}^M \beta_m b(x; \gamma)</script>
      </li>
    </ol>
  </li>
</ul>

<h3 id="232-å‰å‘åˆ†æ­¥ç®—æ³•ä¸-adaboost">2.3.2 å‰å‘åˆ†æ­¥ç®—æ³•ä¸ AdaBoost</h3>

<ul>
  <li>åŠ æ³•æ¨¡å‹ï¼š $f(x) = \sum\limits_{m=1}^M \alpha_m G_m(x)$</li>
  <li>
    <p>æŸå¤±å‡½æ•°ï¼š$L(y, f(x)) = \exp \bigg(-y f(x) \bigg)$</p>
  </li>
  <li>
    <p>åŸºæœ¬åˆ†ç±»å™¨ï¼š$G_m(x)$</p>
  </li>
  <li>
    <p>æµç¨‹</p>

    <ol>
      <li>
        <p>å‡è®¾ç»è¿‡ $m-1$ è½®è¿­ä»£å‰å‘åˆ†æ­¥ç®—æ³•å¾—åˆ° $f_{m-1}(x)$</p>

        <script type="math/tex; mode=display">f_{m-1}(x) = f_{m-2}(x) + \alpha_{m-1} G_{m-1}(x) = \alpha_1 G_1(x) + Â·Â·Â· + \alpha_{m-1} G_{m-1}(x)</script>

        <p>åˆ™ç¬¬ $m$ è½®è¿­ä»£è¯¥åº”å¾—åˆ°</p>

        <script type="math/tex; mode=display">f_m(x) = f_{m-1}(x) + \alpha_m G_m(x)</script>

        <p>è¿™é‡Œçš„ $\alpha_m, G_m(x)$ ä½¿ $f_m(x)$ åœ¨è®­ç»ƒé›†ä¸Šçš„æŸå¤±æœ€å°</p>
      </li>
      <li>
        <p>æœ€å°åŒ–æŸå¤±å‡½æ•°æ±‚ $G^*_m(x)$ å’Œ $\alpha_m$</p>

        <script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}\alpha_m, G_m(x) & = \mathop{\arg\min}\limits_{a, G} \sum\limits_{i=1}^N \exp \bigg[ -y_i \big(f_{m-1}(x_i) + \alpha G(x_i)\big)\bigg] \\ & = \arg\min\limits_{\alpha, G}\sum\limits_{i=1}^N \bar{w}_{mi} \exp \bigg[-y_i \alpha G(x_i)\bigg]\end{aligned} %]]></script>

        <blockquote>
          <ul>
            <li>$\bar{w}<em>{mi} = \exp [-y_i f</em>{m-1}(x_i)]$ï¼Œä¸ä¾èµ– $\alpha$ å’Œ $G$ï¼Œæ‰€ä»¥ä¸æœ€å°åŒ–æ— å…³ã€‚</li>
            <li>$y_i G(x) \in {-1, +1}$</li>
            <li>M1ï¼šåˆ†ç±»æ­£ç¡®çš„æ•°æ®é›†</li>
            <li>M2ï¼šåˆ†ç±»é”™è¯¯çš„æ•°æ®é›†</li>
          </ul>
        </blockquote>

        <script type="math/tex; mode=display">% <![CDATA[
\begin{aligned} \alpha_m, G_m &= \mathop{\arg\min}\limits_{\alpha, G}\sum\limits_{i=1}^N \bar{w}_{mi} \exp [-y_i \alpha G(x_i)] \\ &= \sum\limits_{i \in M1} \bar{w}_{mi} e^{-\alpha} + \sum\limits_{i \in M2} \bar{w}_{mi} e^{-\alpha} + \sum\limits_{i \in M2} \bar{w}_{mi} \left(e^{\alpha} - e^{-\alpha} \right) \\ &= \sum\limits_{i=1}^{M} e^{-\alpha}\bar{w}_{mi} +  \left(e^{\alpha} - e^{-\alpha} \right)\sum\limits_{i \in M2} \bar{w}_{mi} I(y_i \neq G(x_i)) \end{aligned} %]]></script>

        <p>å…ˆæ±‚ï¼š
<script type="math/tex">G^*_m(x) = \mathop{\arg\min}\limits_{G} \sum\limits_{i} \bar{w}_{mi} I(y_i \neq G(x_i))</script></p>

        <p>å†æ±‚ï¼š
<script type="math/tex">% <![CDATA[
\begin{aligned}\alpha_m &= \mathop{\arg\min}\limits_{\alpha} \sum\limits_{i} \bar{w}_{mi} \exp (\alpha y_i G^*(x_i)) \\ &= \mathop{\arg\min}\limits_{\alpha} \sum\limits_{i \in M1}\bar{w}_{mi} e^{-\alpha} + \sum\limits_{i \in M2} \bar{w}_{mi} e^{\alpha} \\ &= \left( e^{\alpha} - e^{-\alpha} \right) \sum\limits_{i} \bar{w}_{mi} I(y_i \neq G(x_i)) + e^{-\alpha} \sum\limits_{i}\bar{w}_{mi}\end{aligned} %]]></script></p>

        <p>æ±‚å¯¼ï¼š</p>

        <script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}\dfrac{\partial L}{\partial \alpha_m} &= \left( e^\alpha + e^{-\alpha} \right) \sum \bar{w}_i I - \sum e^{-\alpha} \bar{w}_i \\ &= \left( e^{2\alpha} +1 \right) \sum \bar{w}_i I - \sum\bar{w}_i = 0\end{aligned} %]]></script>

        <p>æ‰€ä»¥æœ‰ï¼š</p>

        <script type="math/tex; mode=display">% <![CDATA[
\begin{aligned} \alpha &= \frac{1}{2} \ln \frac{\sum\limits_{i} \bar{w}_{mi} - \sum\limits_{i} \bar{w}_{mi} I}{\sum\limits_{i}\bar{w}_{mi}I} \\ &= \frac{1}{2} \ln \frac{1 - e_m}{e_m} \end{aligned} %]]></script>
      </li>
    </ol>

    <p>å…¶ä¸­ï¼š</p>

    <script type="math/tex; mode=display">e_m = \frac{\sum\limits_{i} \bar{w}_{mi} I}{\sum\limits_{i} \bar{w}_{mi}}</script>

    <script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}\bar{w}_{mi} &= \exp \bigg( y_i f_{m-1}(x_i)\bigg) \\ &= \exp \bigg(-y_i \sum\limits_{j=1}^{M-1}\alpha_j G_j(x_i)\bigg) \\&= \prod_j \exp\bigg(-y_i\alpha_j G_j(x_i)\bigg)\end{aligned} %]]></script>
  </li>
</ul>

<hr />

<h2 id="3-ç¼–ç¨‹">3 ç¼–ç¨‹</h2>

<p>å®ç°æå‡ç®—æ³•</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">class</span> <span class="nc">AdaBoost</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">iter_times</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ftrs</span> <span class="o">=</span> <span class="n">features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iter_times</span> <span class="o">=</span> <span class="n">iter_times</span>
        <span class="n">wights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wights</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">base_classifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">ftrs</span><span class="p">,</span> <span class="n">less</span><span class="p">):</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">ftrs</span> <span class="o">&lt;</span> <span class="n">value</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">classes</span> <span class="k">if</span> <span class="n">less</span> <span class="k">else</span> <span class="o">-</span><span class="n">classes</span>

    <span class="k">def</span> <span class="nf">error_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ftrs</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">less</span><span class="p">):</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_classifier</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ftrs</span><span class="p">,</span> <span class="n">less</span><span class="p">)</span>
        <span class="n">err_ratio</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="p">(</span><span class="n">classes</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">err_ratio</span>

    <span class="k">def</span> <span class="nf">get_coff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ftrs</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">less</span><span class="p">):</span>
        <span class="n">err_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_ratio</span><span class="p">(</span><span class="n">ftrs</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">less</span><span class="p">)</span>
        <span class="n">coff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">err_ratio</span><span class="p">)</span> <span class="o">/</span> <span class="n">err_ratio</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">coff</span>

    <span class="k">def</span> <span class="nf">get_best_v</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ftrs</span><span class="p">):</span>
        <span class="n">ftrs</span> <span class="o">=</span> <span class="n">ftrs</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span>
        <span class="n">ftrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">ftrs</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[(</span><span class="n">ftrs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ftrs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ftrs</span><span class="p">))</span>
                            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ftrs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ftrs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">err_ratios</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">error_ratio</span><span class="p">(</span><span class="n">ftrs</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">less</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">less</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
        <span class="n">min_index</span> <span class="o">=</span> <span class="n">err_ratios</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">err_ratios</span><span class="p">))</span>
        <span class="n">less</span> <span class="o">=</span> <span class="n">min_index</span> <span class="o">&lt;</span> <span class="mi">10</span>
        <span class="n">min_index</span> <span class="o">=</span> <span class="n">min_index</span> <span class="o">%</span> <span class="mi">10</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ftrs</span><span class="p">[</span><span class="n">min_index</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">less</span>

    <span class="k">def</span> <span class="nf">renew_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">ftrs</span><span class="p">,</span> <span class="n">less</span><span class="p">):</span>
        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_classifier</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ftrs</span><span class="p">,</span> <span class="n">less</span><span class="p">)</span>
        <span class="n">expon</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_classifier</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ftrs</span><span class="p">,</span> <span class="n">less</span><span class="p">)</span>
        <span class="n">normal_coff</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">expon</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">expon</span><span class="p">)</span> <span class="o">/</span> <span class="n">normal_coff</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter_times</span><span class="p">):</span>
            <span class="n">value</span><span class="p">,</span> <span class="n">less</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best_v</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ftrs</span><span class="p">)</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_coff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ftrs</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">less</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">renew_weights</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ftrs</span><span class="p">,</span> <span class="n">less</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"["</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s">"]"</span><span class="p">,</span> <span class="s">"</span><span class="se">\n</span><span class="s">åˆ†ç±»ç‚¹:"</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="s">"</span><span class="se">\n</span><span class="s">ç³»æ•°:"</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="p">,</span> <span class="s">"</span><span class="se">\n</span><span class="s">æƒé‡:"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">value</span><span class="p">,</span> <span class="n">less</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">features</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="n">func_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">base_classifier</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">less</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">less</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_list</span><span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">func_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">adaboost</span> <span class="o">=</span> <span class="n">AdaBoost</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    <span class="n">adaboost</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</code></pre></div></div>
:ET