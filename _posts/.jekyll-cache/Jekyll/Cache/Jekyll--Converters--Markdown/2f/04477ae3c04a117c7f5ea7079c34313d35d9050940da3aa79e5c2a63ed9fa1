I"áÍ<!-- vim-markdown-toc GFM -->

<ul>
  <li><a href="#1-å‰è¨€">1 å‰è¨€</a>
    <ul>
      <li><a href="#11-æœ¬ç« æ¦‚è¦">1.1 æœ¬ç« æ¦‚è¦</a></li>
      <li><a href="#12-ç›®å½•">1.2 ç›®å½•</a></li>
    </ul>
  </li>
  <li><a href="#2-è¯»ä¹¦ç¬”è®°">2 è¯»ä¹¦ç¬”è®°</a>
    <ul>
      <li><a href="#21-é€»è¾‘å›å½’æ¨¡å‹">2.1 é€»è¾‘å›å½’æ¨¡å‹</a>
        <ul>
          <li><a href="#211-é€»è¾‘åˆ†å¸ƒ">2.1.1 é€»è¾‘åˆ†å¸ƒ</a></li>
          <li><a href="#212-äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹">2.1.2 äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹</a>
            <ul>
              <li><a href="#å‡ ç‡">å‡ ç‡</a></li>
            </ul>
          </li>
          <li><a href="#213-æ¨¡å‹çš„å‚æ•°ä¼°è®¡">2.1.3 æ¨¡å‹çš„å‚æ•°ä¼°è®¡</a></li>
          <li><a href="#214-å¤šé¡¹é€»è¾‘å›å½’æ¨¡å‹">2.1.4 å¤šé¡¹é€»è¾‘å›å½’æ¨¡å‹</a></li>
        </ul>
      </li>
      <li><a href="#22-æœ€å¤§ç†µæ¨¡å‹">2.2 æœ€å¤§ç†µæ¨¡å‹</a>
        <ul>
          <li><a href="#221-æœ€å¤§ç†µåŸç†">2.2.1 æœ€å¤§ç†µåŸç†</a></li>
          <li><a href="#222-æœ€å¤§ç†µæ¨¡å‹çš„å®šä¹‰">2.2.2 æœ€å¤§ç†µæ¨¡å‹çš„å®šä¹‰</a></li>
          <li><a href="#223-æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ ">2.2.3 æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ </a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#3-å¯¼è¯»ç¬”è®°">3 å¯¼è¯»ç¬”è®°</a>
    <ul>
      <li><a href="#31-é€»è¾‘å›å½’æ¨¡å‹">3.1 é€»è¾‘å›å½’æ¨¡å‹</a>
        <ul>
          <li><a href="#æ±‚è§£-w">æ±‚è§£ w</a></li>
        </ul>
      </li>
      <li><a href="#32-æœ€å¤§ç†µæ¨¡å‹">3.2 æœ€å¤§ç†µæ¨¡å‹</a></li>
      <li><a href="#32-æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§">3.2 æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§</a></li>
    </ul>
  </li>
  <li><a href="#4-æ€»ç»“">4 æ€»ç»“</a>
    <ul>
      <li><a href="#41-ä»€ä¹ˆæ˜¯æ¢¯åº¦ä¸‹é™">4.1 ä»€ä¹ˆæ˜¯æ¢¯åº¦ä¸‹é™ï¼Ÿ</a></li>
      <li><a href="#42-ä»€ä¹ˆæ˜¯-logistic-å›å½’">4.2 ä»€ä¹ˆæ˜¯ Logistic å›å½’ï¼Ÿ</a></li>
    </ul>
  </li>
</ul>

<!-- vim-markdown-toc -->

<h1 id="1-å‰è¨€">1 å‰è¨€</h1>

<h2 id="11-æœ¬ç« æ¦‚è¦">1.1 æœ¬ç« æ¦‚è¦</h2>

<ol>
  <li>
    <p>é€»è¾‘å›å½’æ¨¡å‹æ˜¯ç”¨ä¸‹é¢åˆ†å¸ƒè¡¨ç¤ºçš„æ¨¡å‹ï¼Œç”¨äºåˆ†ç±»</p>

    <script type="math/tex; mode=display">P(Y = k \mid x) = \dfrac{e^{w_k \cdot x}} {1 + \sum\limits_{k=1}^{K-1} e^{w_k \cdot x}}</script>

    <script type="math/tex; mode=display">P(Y=K \mid x) = \dfrac{1}{1+\sum\limits_{k=1}^{K-1} e^{w_k \cdot x}}</script>

    <p>å…¶ä¸­
$k = 1, 2, â€¦, K-1$</p>

    <blockquote>
      <p>é€»è¾‘å›å½’æ¨¡å‹æ˜¯ç”¨è¾“å…¥çš„çº¿æ€§å‡½æ•°è¡¨ç¤ºè¾“å‡ºçš„å¯¹æ•°å‡ ç‡æ¨¡å‹</p>
    </blockquote>
  </li>
  <li>
    <p>æœ€å¤§ç†µæ¨¡å‹æ˜¯ç”¨ä¸‹é¢åˆ†å¸ƒè¡¨ç¤ºçš„åˆ†ç±»æ¨¡å‹</p>

    <script type="math/tex; mode=display">P_w(y \mid x) = \dfrac{1}{Z_w(x)} e ^{\sum\limits_{i=1}^{n} w_if_i(x, y)}</script>

    <script type="math/tex; mode=display">Z_w(x) = \sum\limits_y e^{\sum\limits_{i=1}^{n}w_if_i(x, y)}</script>

    <ul>
      <li>$Z_w(x)$ æ˜¯å½’ä¸€åŒ–å› å­</li>
      <li>$f_i$ æ˜¯ç‰¹å¾å‡½æ•°</li>
      <li>$w_i$ ç‰¹å¾æƒå€¼</li>
    </ul>
  </li>
  <li>
    <p>æœ€å¤§ç†µåŸç†è®¤ä¸ºåœ¨æ‰€æœ‰å¯èƒ½çš„æ¦‚ç‡æ¨¡å‹ï¼ˆåˆ†å¸ƒï¼‰çš„é›†åˆä¸­ï¼Œç†µæœ€å¤§çš„æ¨¡å‹æ˜¯æœ€å¥½çš„æ¨¡å‹</p>
  </li>
  <li>
    <p>æœ€å¤§ç†µåŸç†åº”ç”¨åˆ°åˆ†ç±»æ¨¡å‹å­¦ä¹ ä¸­ï¼Œæœ‰ä»¥ä¸‹çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ï¼š</p>

    <script type="math/tex; mode=display">min\{-H(P)\} = \sum\limits_{(x, y)} \widetilde{P}(x)P(y \mid x)logP(y \mid x)</script>

    <p>çº¦æŸæ¡ä»¶ï¼š</p>

    <script type="math/tex; mode=display">P(f_i) - \widetilde{P}(f_i) = 0</script>

    <script type="math/tex; mode=display">\sum\limits_{y} P(y \mid x) = 1</script>

    <p>æ±‚è§£æ­¤ä¼˜åŒ–é—®é¢˜çš„å¯¹å¶é—®é¢˜å¾—åˆ°æœ€å¤§ç†µæ¨¡å‹</p>
  </li>
  <li>
    <p>é€»è¾‘å›å½’æ¨¡å‹å’Œæœ€å¤§ç†µæ¨¡å‹éƒ½æ˜¯å¯¹æ•°çº¿æ€§æ¨¡å‹</p>
  </li>
  <li>
    <p>é€»è¾‘å›å½’æ¨¡å‹å’Œæœ€å¤§ç†µæ¨¡å‹ä¸€èˆ¬ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæˆ–æ­£åˆ™åŒ–çš„æå¤§ä¼¼ç„¶ä¼°è®¡</p>
  </li>
  <li>
    <p>æ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜çš„ç®—æ³•æœ‰è¿­ä»£å°ºåº¦æ³•ã€æ¢¯åº¦ä¸‹é™æ³•ã€æ‹Ÿç‰›é¡¿æ³•</p>
  </li>
</ol>

<h2 id="12-ç›®å½•">1.2 ç›®å½•</h2>

<ol>
  <li>é€»è¾‘å›å½’æ¨¡å‹<br />
1.1 é€»è¾‘åˆ†å¸ƒ<br />
1.2 äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹<br />
1.3 æ¨¡å‹å‚æ•°ä¼°è®¡<br />
1.4 å¤šé¡¹é€»è¾‘å›å½’</li>
  <li>æœ€å¤§ç†µæ¨¡å‹<br />
2.1 æœ€å¤§ç†µåŸç†<br />
2.2 æœ€å¤§ç†µæ¨¡å‹çš„å®šä¹‰<br />
2.3 æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ <br />
2.4 æå¤§ä¼¼ç„¶ä¼°è®¡</li>
  <li>æ¨¡å‹å­¦ä¹ çš„æœ€ä¼˜åŒ–ç®—æ³•<br />
3.1 æ”¹è¿›çš„è¿­ä»£å°ºåº¦æ³•<br />
3.2 æ‹Ÿç‰›é¡¿æ³•</li>
</ol>

<hr />

<h1 id="2-è¯»ä¹¦ç¬”è®°">2 è¯»ä¹¦ç¬”è®°</h1>

<h2 id="21-é€»è¾‘å›å½’æ¨¡å‹">2.1 é€»è¾‘å›å½’æ¨¡å‹</h2>

<h3 id="211-é€»è¾‘åˆ†å¸ƒ">2.1.1 é€»è¾‘åˆ†å¸ƒ</h3>

<p>è®¾ $X$ æ˜¯è¿ç»­éšæœºå˜é‡ï¼Œ $X$ æœä»é€»è¾‘åˆ†å¸ƒæ˜¯æŒ‡ $X$ å…·æœ‰ä»¥ä¸‹åˆ†å¸ƒå‡½æ•°å’Œå¯†åº¦å‡½æ•°ï¼š</p>

<script type="math/tex; mode=display">F(x) = P(X \le x) = \dfrac{1}{1 + e^{-(x-\mu/\gamma)} }</script>

<script type="math/tex; mode=display">f(x) = F'(x) = \dfrac{e^{-(x-\mu)/\gamma}}{\gamma\left[1+e^{-(x-\mu)/\gamma}\right]^2}</script>

<p>å¼ä¸­ï¼Œ $\mu$ ä¸ºä½ç½®å‚æ•°ï¼Œ$\gamma &gt; 0$ ä¸ºå½¢çŠ¶å‚æ•°</p>

<p>é€»è¾‘åˆ†å¸ƒçš„å¯†åº¦å‡½æ•°å’Œåˆ†å¸ƒå‡½æ•°å¦‚ä¸‹ï¼š</p>

<p><img src="/assets/images/posts/2019-08-05-schap6/log.png" alt="logit" /></p>

<h3 id="212-äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹">2.1.2 äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹</h3>

<p>äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹æ˜¯å¦‚ä¸‹çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒï¼š</p>

<script type="math/tex; mode=display">P(Y =1 \mid x) = \dfrac{e^{(w \cdot x _+ b)}}{1 + e^{(w \cdot x + b)}}</script>

<script type="math/tex; mode=display">P(Y = 0 \mid x) = \dfrac{1} {1 + e^{w \cdot x + b}}</script>

<p>å¯¹äºæ–°çš„è¾“å…¥ $x$ï¼Œæ±‚å‡º $P(Y = 1 \mid x)$ å’Œ $P(Y = 0 \mid x)$ï¼Œæ±‚å®ä¾‹ $x$ åˆ†é…åˆ°æ¦‚ç‡å€¼å¤§çš„ä¸€ç±»</p>

<h4 id="å‡ ç‡">å‡ ç‡</h4>

<p>äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ä¸ä¸å‘ç”Ÿæ¦‚ç‡çš„æ¯”å€¼ $\dfrac{p}{1-p}$</p>

<p>å¯¹æ•°å‡ ç‡æˆ– logit å‡½æ•°æ˜¯ï¼š</p>

<script type="math/tex; mode=display">logit(p) = log \dfrac{p}{1-p}</script>

<p>å¯¹æ•°å‡ ç‡çš„çº¿æ€§æ¨¡å‹è¡¨ç¤ºä¸ºï¼š</p>

<script type="math/tex; mode=display">log \dfrac{P(Y=1 \mid x)}{1 - P(Y = 1 \mid x)} = w \cdot x</script>

<p>ç”±æ­¤å¯æ±‚å‡ºé€»è¾‘å›å½’æ¨¡å‹ï¼š</p>

<script type="math/tex; mode=display">P(Y = 1 \mid x) = \dfrac{e^{w \cdot x}}{1 + e^{w \cdot x}}</script>

<script type="math/tex; mode=display">P(Y = 0 \mid x) = \dfrac{1}{1 + e^{w \cdot x}}</script>

<h3 id="213-æ¨¡å‹çš„å‚æ•°ä¼°è®¡">2.1.3 æ¨¡å‹çš„å‚æ•°ä¼°è®¡</h3>

<p>æå¤§ä¼¼ç„¶ä¼°è®¡æ³•ä¼°è®¡å‚æ•°ï¼Œå¯¹äº 0-1 åˆ†å¸ƒçš„æ ·æœ¬ï¼Œæœ‰</p>

<script type="math/tex; mode=display">P(Y = 1 \mid x) = \pi(x)</script>

<script type="math/tex; mode=display">P(Y = 0 \mid x) = 1 - \pi(x)</script>

<p>å¯¹åº”çš„ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p>

<script type="math/tex; mode=display">L(w) = \prod\limits_{i=1}^N = [\pi(x_i)]^{y_i}[1 - \pi(x_i)]^{1-y_i}</script>

<p>å†æ±‚å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„æå¤§å€¼ï¼ˆæ¢¯åº¦ä¸‹é™æˆ–æ‹Ÿç‰›é¡¿æ³•ï¼‰ï¼Œå¯å¾— w çš„ä¼°è®¡å€¼</p>

<p>å½“æ±‚å‡º w çš„æå¤§ä¼¼ç„¶ä¼°è®¡å€¼ $\hat{w}$ åï¼Œé€»è¾‘å›å½’æ¨¡å‹ä¸ºï¼š</p>

<p><script type="math/tex">P(Y = 1 \mid x) = \dfrac {e^{\hat{w} \cdot x}}{1+ e^{\hat{w} \cdot x}}</script><br />
<script type="math/tex">P(Y = 0 \mid x) = \dfrac {1}{1+ e^{\hat{w} \cdot x}}</script></p>

<h3 id="214-å¤šé¡¹é€»è¾‘å›å½’æ¨¡å‹">2.1.4 å¤šé¡¹é€»è¾‘å›å½’æ¨¡å‹</h3>

<p>æ¨¡å‹ä¸ºï¼š</p>

<p><script type="math/tex">P(Y = k \mid x) = \dfrac {e^{w_k \cdot x}}{1+ \sum\limits_{k=1}^{K-1} e^{w_k \cdot x}}</script><br />
<script type="math/tex">P(Y = K \mid x) = \dfrac {1}{1+ \sum\limits_{k=1}^{K-1} e^{w_k \cdot x}}</script></p>

<h2 id="22-æœ€å¤§ç†µæ¨¡å‹">2.2 æœ€å¤§ç†µæ¨¡å‹</h2>

<p>åˆ™æœ€å¤§ç†µåŸç†æ¨å¯¼</p>

<h3 id="221-æœ€å¤§ç†µåŸç†">2.2.1 æœ€å¤§ç†µåŸç†</h3>

<p>æœ€å¤§ç†µåŸç†è®¤ä¸ºåœ¨æ‰€æœ‰å¯èƒ½çš„æ¦‚ç‡æ¨¡å‹ï¼ˆåˆ†å¸ƒï¼‰çš„é›†åˆä¸­ï¼Œç†µæœ€å¤§çš„æ¨¡å‹æ˜¯æœ€å¥½çš„æ¨¡å‹ã€‚çº¦æŸæ¡ä»¶ç¡®å®šæ¦‚ç‡æ¨¡å‹çš„é›†åˆ</p>

<h3 id="222-æœ€å¤§ç†µæ¨¡å‹çš„å®šä¹‰">2.2.2 æœ€å¤§ç†µæ¨¡å‹çš„å®šä¹‰</h3>

<p>å‡è®¾æ»¡è¶³æ‰€æœ‰çš„<strong>çº¦æŸæ¡ä»¶</strong>çš„æ¨¡å‹é›†åˆä¸ºï¼š</p>

<script type="math/tex; mode=display">M = \{ P \in \Gamma \mid E_p(f_i) = E_{\widetilde{P}}(f_i) \}</script>

<p>å®šä¹‰åœ¨æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $P(Y \mid X)$ ä¸Šçš„æ¡ä»¶ç†µä¸ºï¼š</p>

<script type="math/tex; mode=display">H(P) = - \sum\limits_{x, y} \widetilde{P}(x)P(y \mid x) logP(y \mid x)</script>

<p>åˆ™æ¨¡å‹é›†åˆ $M$ ä¸­æ¡ä»¶ç†µ $H(P)$ æœ€å¤§çš„æ¨¡å‹æˆä¸º <strong>æœ€å¤§ç†µæ¨¡å‹</strong></p>

<h3 id="223-æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ ">2.2.3 æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ </h3>

<p>æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ è¿‡ç¨‹å°±æ˜¯æ¨¡å‹çš„æ±‚æœ€ä¼˜è§£è¿‡ç¨‹ã€‚æ‰€ä»¥å­¦ä¹ è¿‡ç¨‹å¯ä»¥è½¬åŒ–æˆçº¦æŸæœ€ä¼˜åŒ–è¿‡ç¨‹</p>

<p>å¯¹äºè®­ç»ƒé›† $T = {(x_1, y_1), (x_2, y_2), â€¦, (x_N, y_N) } $ ä»¥åŠç‰¹å¾å‡½æ•° $ f_i(x, y)$ï¼Œæœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ ç­‰ä»·äºçº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ï¼š</p>

<script type="math/tex; mode=display">\max\limits_{P \in M} H(P) = - \sum\limits_{x,y} \widetilde{P}(x)P(y \mid x)logP(y \mid x)</script>

<p>çº¦æŸæ¡ä»¶ï¼š</p>

<script type="math/tex; mode=display">E_P(f_i) = E_{\widetilde{P}}(f_i), i = 1, 2, ..., n</script>

<script type="math/tex; mode=display">\sum\limits_y P(y \mid x) = 1</script>

<p>æŒ‰æƒ¯ä¾‹è½¬åŒ–ä¸ºæ±‚æœ€å°å€¼é—®é¢˜ï¼š</p>

<script type="math/tex; mode=display">\min\limits_{P \in M} - H(P) = \sum\limits_{x,y} \widetilde{P}(x)P(y \mid x)logP(y \mid x)</script>

<p>çº¦æŸæ¡ä»¶ï¼š</p>

<script type="math/tex; mode=display">E_P(f_i) - E_{\widetilde{P}}(f_i) = 0, i = 1, 2, ..., n</script>

<script type="math/tex; mode=display">\sum\limits_y P(y \mid x) = 1</script>

<p>ä¸Šé¢å¼å­çš„è§£å°±æ˜¯æœ€å¤§ç†µæ¨¡å‹å­¦ä¹ çš„è§£ï¼Œå…¶è§£ä¸ºï¼š</p>

<script type="math/tex; mode=display">w* = arg\max\limits_w \Psi(w)</script>

<p>è¿™é‡Œï¼š</p>

<script type="math/tex; mode=display">\Psi(w) = \min\limits_{P \in M} L(P, w) = L(P_w, w)</script>

<p>$L$ æ˜¯æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š</p>

<script type="math/tex; mode=display">L(P, w) = -H(P) + w_0 \left( 1 - \sum\limits_yP(y \mid x) \right) + \sum\limits_{i=1}^n w_i (E_{\widetilde{P}}(f_i) - E_p(f_i))</script>

<hr />

<h1 id="3-å¯¼è¯»ç¬”è®°">3 å¯¼è¯»ç¬”è®°</h1>

<h2 id="31-é€»è¾‘å›å½’æ¨¡å‹">3.1 é€»è¾‘å›å½’æ¨¡å‹</h2>

<p>å¯¹æ•°çº¿æ€§æ¨¡å‹çš„å½¢å¼ä¸ºï¼š $logP(y \mid x) = w \cdot x$</p>

<p>å¯¹äºç»™å®šçš„ $x$ï¼Œæˆ‘ä»¬å¸Œæœ›æŠŠå®ƒçš„ç±»åˆ«æ¦‚ç‡è¡¨ç¤ºä¸º $P(y = 1 \mid x) = \pi(x)$ï¼Œå…¶ä¸­ $\pi(x) \in [0, 1]$</p>

<p>ä¸ºäº†ç”¨çº¿æ€§å‡½æ•° $w \cdot x$ æ¥è¡¨ç¤º $\pi(x)$ çš„ç‰¹å¾ï¼Œéœ€è¦ä¸€ä¸ªå˜æ¢ï¼ŒæŠŠ $(-\infty, +\infty) \to [0, 1]$ï¼Œç”¨åˆ°äº† logit å˜æ¢ï¼š</p>

<p><script type="math/tex">logit(\pi(x)) = log \dfrac{\pi(x)} {1 - \pi(x)} \in (-\infty, +\infty)</script>
<script type="math/tex">log \dfrac{\pi(x)} {1 - \pi(x)} = w \cdot x</script></p>

<p>åè§£å‡ºé€»è¾‘å›å½’æ¨¡å‹ï¼š</p>

<p><script type="math/tex">\pi(x) = \dfrac{e^{wx}}{1 + e^{wx}} = P(Y = 1 \mid x)</script>
<script type="math/tex">\pi(x) = \dfrac{1}{1 + e^{wx}} = P(Y = 0 \mid x)</script></p>

<p>åªéœ€è¦æ±‚å‡º $w$ å°±æœ‰äº†æ¨¡å‹ï¼Œç„¶åå¯¹äºæ–°çš„ $x$ï¼Œæ±‚å‡ºå¯¹åº”çš„ $P(Y=1 \mid x)$ï¼Œå½“ $P(Y=1 \mid x) &gt; 0.5$ æ—¶ï¼Œåˆ¤å®šåˆ†ç±»ä¸º 1</p>

<h3 id="æ±‚è§£-w">æ±‚è§£ w</h3>

<p>ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ³•æ±‚è§£ $w$ï¼šç»™å®š wï¼Œæ±‚æ ·æœ¬çš„è”åˆæ¦‚ç‡å¯†åº¦ï¼Œè®©å®ƒæœ€å¤§ï¼Œå³å¯æ±‚å‡º w</p>

<p>å¯¹äº $y_i \in {0, 1}$ï¼Œç»™å®š $\pi(x)$ åï¼Œ$y$ çš„æ¦‚ç‡åˆ†å¸ƒä¸ºï¼š</p>

<script type="math/tex; mode=display">P_w(y \mid x) = \pi(x)^y [1 - \pi(x)]^{(1-y)}</script>

<p>å¯¹äº N ä¸ªæ ·æœ¬çš„æå¤§ä¼¼ç„¶ä¼°è®¡å‡½æ•° $L(w)$ï¼š</p>

<script type="math/tex; mode=display">L(w) = \prod\limits_{i=1}^N \pi(x)^{y_i} [1 - \pi(x)]^{(1-y_i)}</script>

<p>åªè¦æ±‚ $\max logL(w)$ çš„ $w$ å³å¯ã€‚ä¸€èˆ¬ç”¨æ¢¯åº¦ä¸‹é™æ³•ï¼Œç»™å®šä¸€ä¸ªåˆå€¼ $w_0$ å³å¯æ‰¾åˆ° $w*$</p>

<h2 id="32-æœ€å¤§ç†µæ¨¡å‹">3.2 æœ€å¤§ç†µæ¨¡å‹</h2>

<p><strong>åŸç†</strong>ï¼šåœ¨æ»¡è¶³çº¦æŸæ¡ä»¶çš„æ¨¡å‹é›†åˆä¸­ï¼Œé€‰æ‹©ç†µæœ€å¤§çš„æ¨¡å‹ï¼ˆæ··ä¹±ç¨‹åº¦æœ€å¤§çš„æ¨¡å‹ï¼‰ã€‚å› ä¸ºåœ¨æ¡ä»¶ä¸è¶³æ—¶ï¼Œåªèƒ½å‡è®¾å„ç§æƒ…å†µå‡ºç°çš„æ¦‚ç‡ç›¸åŒ</p>

<p>ä¾‹å¦‚ï¼šå¯¹äº $X \in {A, B, C, D, E}$ï¼Œä¼°è®¡å„å€¼å‡ºç°çš„æ¦‚ç‡ã€‚</p>

<p>çº¦æŸæ¡ä»¶ï¼š</p>

<script type="math/tex; mode=display">\sum\limits_1^5 P(x_i) = 1</script>

<script type="math/tex; mode=display">P(x_i) \ge 0</script>

<p>åœ¨æ»¡è¶³çº¦æŸçš„æ¨¡å‹ä¸­æ‰¾æœ€ä¹±çš„ï¼Œæ‰€ä»¥å„æ¦‚ç‡ç›¸åŒï¼Œæ‰€ä»¥æœ‰ $P(x_i) = 1/5$</p>

<p>å¯¹äºæ–°çš„çº¦æŸæ¡ä»¶ï¼š</p>

<script type="math/tex; mode=display">P(A) + P(B) = \dfrac{3}{10}</script>

<p>å¦‚ä½•æ‰¾é›†åˆä¸­ç†µæœ€å¤§çš„æ¨¡å‹</p>

<p>å› ä¸ºç†µ $H(p) = - \sum p_i log p_i,\max H = \min [-H]$ï¼Œæ‰€ä»¥ï¼š</p>

<p>è¦æ±‚çš„æ¨¡å‹ç­‰ä»·äºæ±‚æœ€ä¼˜é—®é¢˜ï¼š</p>

<script type="math/tex; mode=display">\min[-H(p)] = \sum\limits_{i=1}^5 P(y_i) \log P(y_i)</script>

<p>çº¦æŸæ¡ä»¶ï¼š</p>

<script type="math/tex; mode=display">\sum\limits_1^5 P(x_i) = 1</script>

<script type="math/tex; mode=display">P(x_i) \ge 0</script>

<script type="math/tex; mode=display">P(A) + P(B) = \dfrac{3}{10}</script>

<p>æˆ‘ä»¬ $x$ æ˜¯å·²çŸ¥çš„ï¼Œå¦‚ä½•æŠŠå·²çŸ¥çš„ $x$ ä¿¡æ¯åŠ å…¥æ¥æ±‚ $p(y)$ï¼Ÿ</p>

<p>ç”¨æ¡ä»¶ç†µï¼š</p>

<script type="math/tex; mode=display">H(p) = -\sum\limits_{x, y} \widetilde{p}(x)p(y \mid x) \log P(y \mid x)</script>

<p>å› ä¸ºç†µ $H(p) = -\sum p_i \log p_i$</p>

<script type="math/tex; mode=display">H(y \mid x) = - \sum p(y \mid x) \log p(y \mid x)</script>

<p>æ‰€ä»¥ï¼š</p>

<script type="math/tex; mode=display">H(p) = E_x H(y \mid x) = \sum\limits_{x, y} p(x) p(y \mid x) \log p(y \mid x)</script>

<p>æˆ‘ä»¬å¸Œæœ›æ€»ä½“ $x$ çš„åˆ†å¸ƒç”¨æ ·æœ¬ä¸Šçš„ $x$ åˆ†å¸ƒï¼ˆä¹Ÿç§°ç»éªŒåˆ†å¸ƒï¼‰æ¥ä»£æ›¿ï¼Œå³</p>

<script type="math/tex; mode=display">\sum\limits_{x, y} p(x) p(y \mid x) \log p(y \mid x) = \sum\limits_{x, y} \widetilde{p}(x)p(y \mid x) \log P(y \mid x)</script>

<p>å°±è¦å¼•å…¥çº¦æŸæ¡ä»¶ï¼š</p>

<script type="math/tex; mode=display">E_{p(x, y)} f_i(x, y) = E_{\widetilde{p}(x, y)}f_i(x, y)</script>

<p>ä¸Šå¼çš„ $p(x, y)$ ä¸ºè”åˆæ¦‚ç‡åˆ†å¸ƒï¼Œä¸Šå¼çš„å«ä¹‰æ˜¯è®©æ¯ä¸ªç‰¹å¾åœ¨æ€»ä½“ä¸­å‡ºç°çš„æ¦‚ç‡ = æ ·æœ¬ä¸­å‡ºç°çš„æ¦‚ç‡</p>

<p>å…¶ä¸­ $f_i(x, y)$ æ˜¯ç‰¹å¾å‡½æ•°ï¼Œä»£è¡¨è§‚å¯Ÿåˆ°çš„ä¿¡æ¯</p>

<p>è¿™æ ·æœ€å¤§ç†µæ¨¡å‹å¯¹åº”çš„æœ€ä¼˜åŒ–é—®é¢˜å¦‚ä¸‹ï¼š</p>

<script type="math/tex; mode=display">\max\limits_{p \in M} H(p) = - \sum\limits_{x, y} \widetilde{p}(x) p(y \mid x) \log p(y \mid x)</script>

<p>çº¦æŸæ¡ä»¶ n+1 ä¸ªï¼š</p>

<script type="math/tex; mode=display">E_p(f_i) = E_{\widetilde{p}}(f_i)</script>

<script type="math/tex; mode=display">\sum\limits_y p(y \mid x) = 1</script>

<p>å…¶ä¸­ï¼š$i = 1, 2, â€¦, n$</p>

<p>æœ€ä¼˜é—®é¢˜çš„æ±‚è§£ç»“æœä¸ºï¼š</p>

<script type="math/tex; mode=display">P_w(y \mid x) = \dfrac{1}{Z_w(x)} e^{\sum\limits_{i=1}^n w_if_i}</script>

<p>å…¶ä¸­ï¼š</p>

<script type="math/tex; mode=display">w = arg\max L_{\widetilde{p}} (P_w) = \log \pi(y \mid x)</script>

<p>æ±‚è§£çš„æµç¨‹ï¼š</p>

<ol>
  <li>ç»™å®šä¸€ä¸ª $x$ï¼Œæ±‚ $y$ å–ä¸åŒå€¼æ—¶å¯¹åº”çš„æ¦‚ç‡åˆ†å¸ƒ</li>
  <li>$(x, y)$ æ»¡è¶³ n ä¸ª $f_i$ çš„è¦æ±‚ï¼Œ$w_i$ æ˜¯ç‰¹å¾ $f_i$ çš„é‡è¦ç¨‹åº¦ï¼Œå½“æ»¡è¶³çš„ç‰¹å¾è¶Šå¤šä¸”ç‰¹å¾è¶Šé‡è¦ï¼Œ$P_w$ å€¼è¶Šå¤§</li>
  <li>æ±‚ $w$ï¼Œä»£å…¥ $P_w(y \mid x)$ å°±å¾—åˆ°æ¨¡å‹</li>
</ol>

<h2 id="32-æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§">3.2 æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§</h2>

<p>å¯¹äºä»»æ„çš„ä¼˜åŒ–é—®é¢˜ï¼Œæœ‰ä¸€ä¸ªä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°ï¼Œè®°ä¸º $f$ï¼Œéœ€è¦ä¼˜åŒ–çš„å˜é‡è®°ä¸º $x$ï¼Œçº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ä¸€èˆ¬å½¢å¼ä¸ºï¼š</p>

<script type="math/tex; mode=display">\min\limits_{x \in R^n} f(x)</script>

<p>çº¦æŸæ¡ä»¶ï¼š</p>

<script type="math/tex; mode=display">c_i(x) \le 0,  i = 1, 2, ..., k</script>

<script type="math/tex; mode=display">h_j(x) = 0, j =1,2, ..., l</script>

<p>$c_i$ ç§°ä¸ºä¸ç­‰å¼çº¦æŸï¼Œ$h$ ç§°ä¸ºç­‰å¼çº¦æŸ</p>

<p>ä»¥ä¸Šçš„åŸå§‹é—®é¢˜è®°ä¸º $P$ï¼Œå®ƒå¯¹åº”ä¸€ä¸ªæ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š</p>

<script type="math/tex; mode=display">L(x, \alpha, \beta) = f(x) + \sum\limits_{i =1}^k \alpha_i c_i(x) + \sum\limits_{j=1}^l \beta_j h_j(x)</script>

<p>å…¶ä¸­ï¼š$\alpha$ ç§°ä¸ºä¸ç­‰å¼çº¦æŸå› å­ï¼Œ$\beta$ ç§°ä¸ºç­‰å¼çº¦æŸå› å­ï¼Œ$\alpha_i$ å¯¹åº”ç¬¬ $i$ ä¸ªä¸ç­‰å¼çº¦æŸï¼Œ$\alpha_i \ge 0$ï¼Œ$\beta_j$ ä¸ä½œè¦æ±‚ã€‚</p>

<p>æ»¡è¶³çº¦æŸæ¡ä»¶çš„ $x$ çš„èŒƒå›´ç§°ä¸ºå¯è¡ŒåŸŸï¼Œå³æŠŠ $k+l$ ä¸ªé›†åˆæ±‚äº¤é›†ã€‚</p>

<p>ä¼˜åŒ–é—®é¢˜å°±æ˜¯åœ¨å¯è¡ŒåŸŸä¸­ï¼Œæ‰¾åˆ° $x$ ä½¿ $f$ æœ€å°ï¼Œå¯¹åº”çš„ç»“æœå°±æ˜¯ $x<em>, P</em>$ï¼Œç”¨æ•°å­¦è¡¨è¾¾å¼å†™ä½œï¼š</p>

<script type="math/tex; mode=display">% <![CDATA[
P = \min\limits_x \max\limits_{\alpha, \beta} L(x, \alpha, \beta) = \left\{
\begin{aligned}
f(x) && c_i(x) \le 0, h_j(x) = 0 \\
\infty && å…¶ä»– \\
\end{aligned}
\right. %]]></script>

<p>ä¹Ÿå°±æ˜¯æ»¡è¶³å°½å¯èƒ½å¤šçš„çº¦æŸä¸‹ï¼Œè®© $f$ å–åˆ°æœ€å°å€¼</p>

<blockquote>
  <ol>
    <li>å½“ $c_i, h_j$ æ— çº¦æŸæ—¶ï¼Œæ€»å¯ä»¥è®©åé¢çš„éƒ¨åˆ†ä¸º $\infty$</li>
    <li>å½“ $c_i(x) \le 0, h_j(x) = 0$ æ—¶ï¼Œ$L$ è¦æœ€å¤§ï¼Œç¬¬ 3 é¡¹ä¸º 0 ç¬¬ 2 é¡¹å°äº 0ï¼Œæ‰€ä»¥æœ€å¤§ä¸º $f(x)$</li>
  </ol>
</blockquote>

<p>å› æ­¤ï¼ŒåŸå§‹é—®é¢˜ç­‰ä»·äºæå°æå¤§åŒ– $L$ å‡½æ•°ï¼Œæ‰€ä»¥åŸå§‹é—®é¢˜çš„å¯¹å¶æ€§é—®é¢˜å¯ä»¥å†™æˆï¼š</p>

<script type="math/tex; mode=display">\max\limits_{\alpha, \beta} \min\limits_x L</script>

<p>é¦–å…ˆæ±‚æ— çº¦æŸé—®é¢˜ï¼Œå†æ±‚æœ‰çº¦æŸæœ€ä¼˜é—®é¢˜</p>

<p>å› æ­¤ï¼Œæ‹‰æ ¼æœ—æ—¥å¯¹å¶é—®é¢˜ä¸ºï¼š</p>

<script type="math/tex; mode=display">\max\limits_{\alpha, \beta} \min\limits_x L(x, \alpha, \beta)</script>

<p>çº¦æŸæ¡ä»¶ $\alpha_i \ge 0$ï¼Œæœ€ä¼˜è§£ï¼š$\alpha^<em>, \beta^</em>$ï¼Œæœ€ä¼˜å€¼ $d^*$</p>

<p>ä¸‹é¢å†çœ‹ $P^<em>$ å’Œ $d^</em>$ çš„å…³ç³»</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned} d^* =\max\limits_{\alpha, \beta} \min\limits_x L(x, \alpha, \beta) &\le \max\limits_{\alpha, \beta} \min\limits_{x \inå¯è¡ŒåŸŸ} L(x, \alpha, \beta) \\ &\le \max\limits_{\alpha, \beta} \min\limits_{x \inå¯è¡ŒåŸŸ}f(x) = \min\limits_{x \inå¯è¡ŒåŸŸ}f(x) = P^*\end{aligned} %]]></script>

<p>å¯¹å¶é—®é¢˜çš„æœ€ä¼˜å€¼ç»™åŸå§‹é—®é¢˜çš„æœ€ä¼˜å€¼æä¾›äº†ä¸‹ç•Œï¼Œ$P^* \ge d^*$</p>

<p>ä»€ä¹ˆæ—¶å€™ $P^* = d^*$ ? å½“åŸå§‹é—®é¢˜æ»¡è¶³ï¼š</p>

<hr />

<h1 id="4-æ€»ç»“">4 æ€»ç»“</h1>

<h2 id="41-ä»€ä¹ˆæ˜¯æ¢¯åº¦ä¸‹é™">4.1 ä»€ä¹ˆæ˜¯æ¢¯åº¦ä¸‹é™ï¼Ÿ</h2>

<ol>
  <li>
    <p>æ¢¯åº¦æ–¹å‘æ˜¯å‡½æ•°å¢é•¿æœ€å¿«çš„æ–¹å‘ï¼Œè´Ÿæ¢¯åº¦æ˜¯å‡½æ•°å‡å°æœ€å¿«çš„æ–¹å‘</p>
  </li>
  <li>
    <p>è¦æ±‚å‡½æ•°çš„æœ€å°å€¼ï¼Œå¯ä»¥ä»ä»»æ„ç‚¹ $X_0 = (x_1, x_2, â€¦, x_n)$ å¼€å§‹è¿›è¡Œä¸€ä¸ªè¿­ä»£è¿‡ç¨‹</p>

    <script type="math/tex; mode=display">x^{(i+1)}_1 = x^{(i)}_1 - lr * \frac{âˆ‚f}{âˆ‚x_1}</script>

    <script type="math/tex; mode=display">x^{(i+1)}_2 = x^{(i)}_2 - lr * \frac{âˆ‚f}{âˆ‚x_2}</script>

    <script type="math/tex; mode=display">... ...</script>

    <script type="math/tex; mode=display">x^{(i+1)}_n = x^{(i)}_n - lr * \frac{âˆ‚f}{âˆ‚x_n}</script>

    <p>ä¸€ç›´åˆ°æ”¶æ•›æ¡ä»¶æ»¡è¶³</p>
  </li>
</ol>

<h2 id="42-ä»€ä¹ˆæ˜¯-logistic-å›å½’">4.2 ä»€ä¹ˆæ˜¯ Logistic å›å½’ï¼Ÿ</h2>

<p>å¯ä»¥æƒ³æˆå¯¹æ•°å‡ ç‡ã€æ‹Ÿåˆã€‘ï¼Œå°±æ˜¯ç”¨çº¿æ€§å‡½æ•° wx å»æ‹Ÿåˆå¯¹æ•°å‡ ç‡</p>

<ul>
  <li>
    <p>ä¸ºä»€ä¹ˆæ˜¯å¯¹æ•°å‡ ç‡ï¼Ÿ</p>

    <p>å› ä¸º</p>

    <p>$  wx = \log \frac{p}{1-p} &gt; log 1 = 0$</p>

    <p>æ‰€ä»¥å½“ $wx &gt; 0$ æ˜¯å¯ä»¥çŸ¥é“ $\dfrac{p}{1-p} &gt; 1$ï¼Œå°±è¯´æ˜æ ·æœ¬ $x$ æ˜¯æ­£æ ·æœ¬</p>
  </li>
  <li>
    <p>ä¸ºä»€ä¹ˆ wx &gt; 0 æ—¶ï¼Œx æ˜¯æ­£æ ·æœ¬ï¼Ÿ</p>

    <p>å› ä¸º $wx = \log \dfrac{p}{1-p}$ï¼Œè¿™é‡Œ $p = p(Y=1 \mid x)$</p>

    <p>é‚£ä¹ˆå½“ $p&gt;0.5$ æ—¶ï¼Œ$\dfrac{p}{1-p}&gt;1$ , $\log \dfrac{p}{1-p} &gt; 0$</p>
  </li>
  <li>
    <p>ä»€ä¹ˆæ˜¯ Logistic å›å½’æ¨¡å‹ï¼Ÿ</p>

    <p>Logistic å›å½’æ˜¯ç»Ÿè®¡å­¦ä¹ ä¸­çš„åˆ†ç±»æ–¹æ³•</p>

    <ul>
      <li>
        <p>ç»Ÿè®¡å­¦ä¹ </p>

        <p>è®¡ç®—æœºåŸºäºæ•°æ®æ„å»ºæ¦‚ç‡ç»Ÿè®¡æ¨¡å‹ï¼Œå¹¶ç”¨æ¨¡å‹å¯¹æ•°æ®è¿›è¡Œé¢„æµ‹ä¸åˆ†æçš„å­¦ç§‘</p>
      </li>
      <li>
        <p>ç»Ÿè®¡å­¦ä¹ çš„æ–¹æ³•</p>

        <p>åœ¨å‡è®¾æ•°æ®é›†æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒäº§ç”Ÿçš„å‰æä¸‹ï¼Œåº”ç”¨æŸä¸ªè¯„ä»·æ ‡å‡†ï¼Œä»å‡è®¾ç©ºé—´ä¸­æ ¹æ®æœ€ä¼˜ç®—æ³•é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜çš„æ¨¡å‹ã€‚ç»Ÿè®¡å­¦ä¹ æ–¹æ³•çš„ä¸‰è¦ç´ ï¼šæ¨¡å‹çš„å‡è®¾ç©ºé—´ã€æ¨¡å‹é€‰æ‹©çš„æ ‡å‡†ã€æ¨¡å‹å­¦ä¹ çš„ç®—æ³•</p>
      </li>
    </ul>

    <p>Logistic å›å½’æ¨¡å‹æ˜¯åˆ©ç”¨ Logistic å›å½’æ–¹æ³•å¾—åˆ°çš„ä¸€ä¸ªçº¿æ€§åˆ†ç±»æ¨¡å‹ï¼Œè¿™ä¸ªçº¿æ€§æ¨¡å‹çš„å‡è®¾ç©ºé—´æ˜¯çº¿æ€§ç©ºé—´ wxï¼Œè¿™ä¸ªçº¿æ€§æ¨¡å‹çš„è¯„ä»·å‡†åˆ™æ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡ï¼Œè¿™ä¸ªçº¿æ€§æ¨¡å‹çš„æœ€ä¼˜ç®—æ³•æ˜¯ç”¨æ¢¯åº¦ä¸‹é™æ³•</p>

    <blockquote>
      <p>å‡è®¾ç©ºé—´æ˜¯è¾“å…¥ç©ºé—´åˆ°è¾“å‡ºç©ºé—´çš„æ˜ å°„çš„é›†åˆ</p>
    </blockquote>
  </li>
  <li>
    <p>Logistic å›å½’çš„ç”±æ¥ï¼š</p>

    <p>å¸Œæœ›é€šè¿‡ wx ç›´æ¥é¢„æµ‹ x å±äºæ­£æ ·æœ¬çš„æ¦‚ç‡ã€‚ä½† wx å€¼åŸŸæ— ç•Œï¼Œæ‰€ä»¥ç”¨ sigmoid å‡½æ•°æŠŠ wx æ˜ å°„åˆ°[0, 1]ï¼Œæ‰€ä»¥æœ‰ $p(Y=1 \mid x) = sigmoid(x)$</p>
  </li>
  <li>
    <p>æå¤§ä¼¼ç„¶ä¼°è®¡</p>

    <p>å¯¹å‚æ•°çš„æ±‚è§£é‡‡ç”¨äº†æå¤§ä¼¼ç„¶ä¼°è®¡ï¼Œç”±æ•°æ®é›†çš„åˆ†å¸ƒ</p>

    <script type="math/tex; mode=display">p(y=1 \mid x) = sigmoid(x) = \dfrac{1}{1 + e^{-wx}}</script>

    <script type="math/tex; mode=display">p(y=0 \mid x) = 1 - sigmoid(x) = \dfrac{e^{-wx}}{1 + e^{-wx}}</script>

    <p>å¯ä»¥å°†åˆ†å¸ƒç»Ÿä¸€å†™æˆï¼š</p>

    <script type="math/tex; mode=display">p(y \mid x, w) = h^y(x)(1-h(x))^{1-y}</script>

    <p>é‚£ä¹ˆå¯¹äºè®­ç»ƒæ ·æœ¬ $D = {(x_1, y_1), (x_2, y_2), â€¦, (x_n, y_n)}$ï¼Œæœ‰æå¤§ä¼¼ç„¶å‡½æ•°ï¼š</p>

    <script type="math/tex; mode=display">L(w) = \prod\limits_{i=1}^N \pi(x)^{y_i} [1 - \pi(x)]^{(1-y_i)}</script>

    <p>å…¶ä¸­ï¼š</p>

    <script type="math/tex; mode=display">P(Y = 1 \mid x) = \pi(x)</script>

    <p>æ‰€ä»¥å®ƒçš„å¯¹æ•°ä¼¼ç„¶ä¼°è®¡å°±æ˜¯ï¼š</p>

    <script type="math/tex; mode=display">\log L(w) = \sum\limits_{i=1}^N (y_i \log h(x_i) + (1-y_i)\log (1-h(x_i)))</script>

    <p>é‚£ä¹ˆç°åœ¨è¦æ±‚æœ€å¤§ä¼¼ç„¶ä¼°è®¡å€¼ï¼Œç­‰ä»·äºæ±‚å¦‚ä¸‹æœ€å°é—®é¢˜ï¼š</p>

    <script type="math/tex; mode=display">\min\limits_w (-f(w))</script>

    <p>è¿™ä¸ªå°±æ˜¯å­¦ä¹ æ–¹æ³•çš„<strong>è¯„ä»·æ ‡å‡†</strong></p>
  </li>
  <li>
    <p>æ¢¯åº¦ä¸‹é™æ³•</p>

    <p>è¿™æ˜¯æœ€ä¼˜ç®—æ³•ï¼Œå¯»æ‰¾æœ€ä¼˜æ¨¡å‹ã€‚ç›®æ ‡å‡½æ•°çš„æ¢¯åº¦ä¸ºï¼š</p>

    <script type="math/tex; mode=display">% <![CDATA[
\begin{aligned} - \nabla f(w) &= - \nabla \left(\sum\limits_{i=1}^N (y_i \log h(x_i) + (1-y_i)\log (1-h(x_i)))\right)  \\ &= \sum\limits_{i=1}^N \left(h(x_i) - y_i \right)x_i \end{aligned} %]]></script>

    <p>å¾—åˆ°æ¢¯åº¦åï¼Œw çš„æ›´æ–°å…¬å¼ï¼š</p>

    <script type="math/tex; mode=display">w_{k+1} = w_k - \alpha \sum\limits_{i=1}^N \left(h_w(x_i) - y_i \right)x_i</script>
  </li>
</ul>

<h1 id="5-ä»£ç å®è·µ">5 ä»£ç å®è·µ</h1>

<h2 id="51-ç”Ÿæˆæ•°æ®">5.1 ç”Ÿæˆæ•°æ®</h2>

<p>ä»testSet.txtä¸­è¯»å–æµ‹è¯•æ•°æ®</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">load_dataset</span><span class="p">():</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'testSet.txt'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fr</span><span class="p">:</span>
        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fr</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>

    <span class="n">dataset</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div></div>

<blockquote>
  <p><a href="/assets/images/posts/2019-08-05-schap6/testSet.txt">test</a></p>
</blockquote>

<h2 id="52-ç»˜åˆ¶æ•°æ®">5.2 ç»˜åˆ¶æ•°æ®</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_dataset</span><span class="p">(</span><span class="n">data_list</span><span class="p">):</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_list</span> <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">'0'</span><span class="p">]</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_list</span> <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">'0'</span><span class="p">]</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_list</span> <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">'1'</span><span class="p">]</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_list</span> <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">'1'</span><span class="p">]</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"æ•°æ®åˆ†å¸ƒ"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'deeppink'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'darkblue'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># plt.show()
</span></code></pre></div></div>
<p><img src="/assets/images/posts/2019-08-05-schap6/2.png" alt="" /></p>

<h3 id="521-scatter-å‡½æ•°">5.2.1 scatter å‡½æ•°</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">marker</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">vmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">linewidths</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">verts</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">hold</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></div>

<p>å¸¸ç”¨å‚æ•°è¯´æ˜ï¼š</p>

<table>
  <thead>
    <tr>
      <th>å‚æ•°</th>
      <th>ç±»å‹</th>
      <th>è¯´æ˜</th>
      <th>é»˜è®¤å€¼</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>xï¼Œy</td>
      <td>array</td>
      <td>è¡¨ç¤º x è½´ä¸ y è½´å¯¹åº”çš„æ•°æ®ï¼›</td>
      <td>æ— </td>
    </tr>
    <tr>
      <td>s</td>
      <td>æ•°å€¼æˆ–ä¸€ç»´çš„array</td>
      <td>è¡¨ç¤ºæ•£ç‚¹å›¾ä¸­ç‚¹çš„å¤§å°ï¼Œè‹¥æ˜¯ä¸€ç»´æ•°ç»„ï¼Œåˆ™è¡¨ç¤ºæ•£ç‚¹å›¾ä¸­æ¯ä¸ªç‚¹çš„å¤§å°ï¼›</td>
      <td>None</td>
    </tr>
    <tr>
      <td>c</td>
      <td>é¢œè‰²æˆ–ä¸€ç»´çš„array</td>
      <td>è¡¨ç¤ºæ•£ç‚¹å›¾ä¸­ç‚¹çš„é¢œè‰²ï¼Œè‹¥æ˜¯ä¸€ç»´æ•°ç»„ï¼Œåˆ™è¡¨ç¤ºæ•£ç‚¹å›¾ä¸­æ¯ä¸ªç‚¹çš„é¢œè‰²ï¼›</td>
      <td>None</td>
    </tr>
    <tr>
      <td>marker</td>
      <td>string</td>
      <td>è¡¨ç¤ºæ•£ç‚¹çš„ç±»å‹ï¼›</td>
      <td>o</td>
    </tr>
    <tr>
      <td>alpha</td>
      <td>0~1ä¹‹é—´çš„å°æ•°</td>
      <td>è¡¨ç¤ºæ•£ç‚¹çš„é€æ˜åº¦ï¼›</td>
      <td>None</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>
    <p><strong>x/yï¼šæ•°æ®</strong></p>

    <p>éƒ½æ˜¯å‘é‡ï¼Œè€Œä¸”å¿…é¡»é•¿åº¦ç›¸ç­‰</p>
  </li>
  <li>
    <p><strong>sï¼šæ ‡è®°å¤§å°</strong></p>

    <p>ä»¥å¹³æ–¹ç£…ä¸ºå•ä½çš„æ ‡è®°é¢ç§¯ï¼ŒæŒ‡å®šä¸ºä¸‹åˆ—å½¢å¼ä¹‹ä¸€ï¼š</p>

    <ul>
      <li>
        <p><strong>æ•°å€¼æ ‡é‡</strong>ï¼š ä»¥ç›¸åŒçš„å¤§å°ç»˜åˆ¶æ‰€æœ‰æ ‡è®°</p>
      </li>
      <li>
        <p><strong>è¡Œæˆ–åˆ—å‘é‡</strong>ï¼š ä½¿æ¯ä¸ªæ ‡è®°å…·æœ‰ä¸åŒçš„å¤§å°ã€‚xã€y å’Œ sz ä¸­çš„ç›¸åº”å…ƒç´ ç¡®å®šæ¯ä¸ªæ ‡è®°çš„ä½ç½®å’Œé¢ç§¯ã€‚sz çš„é•¿åº¦å¿…é¡»ç­‰äº x å’Œ y çš„é•¿åº¦ã€‚</p>
      </li>
      <li>
        <p><strong>[]</strong>ï¼š ä½¿ç”¨ 36 å¹³æ–¹ç£…çš„é»˜è®¤é¢ç§¯ã€‚</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>Cï¼šæ ‡è®°é¢œè‰²</strong></p>

    <p>æ ‡è®°é¢œè‰²ï¼ŒæŒ‡å®šä¸ºä¸‹åˆ—å½¢å¼ä¹‹ä¸€ï¼š</p>

    <ul>
      <li>
        <p>RGB ä¸‰å…ƒæ•°æˆ–é¢œè‰²åç§° - ä½¿ç”¨ç›¸åŒçš„é¢œè‰²ç»˜åˆ¶æ‰€æœ‰æ ‡è®°ã€‚</p>
      </li>
      <li>
        <p>ç”± RGB ä¸‰å…ƒæ•°ç»„æˆçš„ä¸‰åˆ—çŸ©é˜µ - å¯¹æ¯ä¸ªæ ‡è®°ä½¿ç”¨ä¸åŒçš„é¢œè‰²ã€‚çŸ©é˜µçš„æ¯è¡Œä¸ºå¯¹åº”æ ‡è®°æŒ‡å®šä¸€ç§ RGB ä¸‰å…ƒæ•°é¢œè‰²ã€‚è¡Œæ•°å¿…é¡»ç­‰äº x å’Œ y çš„é•¿åº¦ã€‚</p>
      </li>
      <li>
        <p>å‘é‡ - å¯¹æ¯ä¸ªæ ‡è®°ä½¿ç”¨ä¸åŒçš„é¢œè‰²ï¼Œå¹¶ä»¥çº¿æ€§æ–¹å¼å°† c ä¸­çš„å€¼æ˜ å°„åˆ°å½“å‰é¢œè‰²å›¾ä¸­çš„é¢œè‰²ã€‚c çš„é•¿åº¦å¿…é¡»ç­‰äº x å’Œ y çš„é•¿åº¦ã€‚è¦æ›´æ”¹åæ ‡åŒºçš„é¢œè‰²å›¾ï¼Œè¯·ä½¿ç”¨ colormap å‡½æ•°ã€‚</p>
      </li>
    </ul>

    <p>å¦‚æœæ•£ç‚¹å›¾ä¸­æœ‰ä¸‰ä¸ªç‚¹ï¼Œå¹¶ä¸”æ‚¨å¸Œæœ›è¿™äº›é¢œè‰²æˆä¸ºé¢œè‰²å›¾çš„ç´¢å¼•ï¼Œè¯·ä»¥ä¸‰å…ƒç´ åˆ—å‘é‡çš„å½¢å¼æŒ‡å®š cã€‚</p>

    <table>
      <thead>
        <tr>
          <th>é€‰é¡¹</th>
          <th>è¯´æ˜</th>
          <th>å¯¹åº”çš„ RGB ä¸‰å…ƒæ•°</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>â€˜redâ€™ æˆ– â€˜râ€™</td>
          <td>çº¢è‰²</td>
          <td>[1 0 0]</td>
        </tr>
        <tr>
          <td>â€˜greenâ€™ æˆ– â€˜gâ€™</td>
          <td>ç»¿è‰²</td>
          <td>[0 1 0]</td>
        </tr>
        <tr>
          <td>â€˜blueâ€™ æˆ– â€˜bâ€™</td>
          <td>è“è‰²</td>
          <td>[0 0 1]</td>
        </tr>
        <tr>
          <td>â€˜yellowâ€™ æˆ– â€˜yâ€™</td>
          <td>é»„è‰²</td>
          <td>[1 1 0]</td>
        </tr>
        <tr>
          <td>â€˜magentaâ€™ æˆ– â€˜mâ€™</td>
          <td>å“çº¢è‰²</td>
          <td>[1 0 1 ]</td>
        </tr>
        <tr>
          <td>â€˜cyanâ€™ æˆ– â€˜câ€™</td>
          <td>é’è“è‰²</td>
          <td>[0 1 1]</td>
        </tr>
        <tr>
          <td>â€˜whiteâ€™ æˆ– â€˜wâ€™</td>
          <td>ç™½è‰²</td>
          <td>[1 1 1]</td>
        </tr>
        <tr>
          <td>â€˜blackâ€™ æˆ– â€˜kâ€™</td>
          <td>é»‘è‰²</td>
          <td>[0 0 0]</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p><strong>marker: æ ‡è®°æ ·å¼</strong></p>

    <table>
      <thead>
        <tr>
          <th style="text-align: center">å€¼</th>
          <th style="text-align: center">è¯´æ˜</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="text-align: center">â€˜oâ€™</td>
          <td style="text-align: center">åœ†åœˆ</td>
        </tr>
        <tr>
          <td style="text-align: center">â€™+â€™</td>
          <td style="text-align: center">åŠ å·</td>
        </tr>
        <tr>
          <td style="text-align: center">â€™*â€™</td>
          <td style="text-align: center">æ˜Ÿå·</td>
        </tr>
        <tr>
          <td style="text-align: center">â€™.â€™</td>
          <td style="text-align: center">ç‚¹</td>
        </tr>
        <tr>
          <td style="text-align: center">â€˜xâ€™</td>
          <td style="text-align: center">å‰å·</td>
        </tr>
        <tr>
          <td style="text-align: center">â€˜squareâ€™ æˆ– â€˜sâ€™</td>
          <td style="text-align: center">æ–¹å½¢</td>
        </tr>
        <tr>
          <td style="text-align: center">â€˜diamondâ€™ æˆ– â€˜dâ€™</td>
          <td style="text-align: center">è±å½¢</td>
        </tr>
        <tr>
          <td style="text-align: center">â€™^â€™</td>
          <td style="text-align: center">ä¸Šä¸‰è§’</td>
        </tr>
        <tr>
          <td style="text-align: center">â€˜vâ€™</td>
          <td style="text-align: center">ä¸‹ä¸‰è§’</td>
        </tr>
        <tr>
          <td style="text-align: center">â€™&gt;â€™</td>
          <td style="text-align: center">å³ä¸‰è§’</td>
        </tr>
        <tr>
          <td style="text-align: center">â€™&lt;â€™</td>
          <td style="text-align: center">å·¦ä¸‰è§’</td>
        </tr>
        <tr>
          <td style="text-align: center">â€˜pentagramâ€™ æˆ– â€˜pâ€™</td>
          <td style="text-align: center">äº”è§’æ˜Ÿï¼ˆäº”è§’å½¢ï¼‰</td>
        </tr>
        <tr>
          <td style="text-align: center">â€˜hexagramâ€™ æˆ– â€˜hâ€™</td>
          <td style="text-align: center">å…­è§’æ˜Ÿï¼ˆå…­è§’å½¢ï¼‰</td>
        </tr>
        <tr>
          <td style="text-align: center">â€˜noneâ€™</td>
          <td style="text-align: center">æ— æ ‡è®°</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p><strong>edgecolors</strong>ï¼šè½®å»“é¢œè‰²</p>

    <p>å¦‚æœæ— ï¼Œåˆ™é»˜è®¤ä¸ºâ€™faceâ€™ã€‚å¦‚æœâ€™faceâ€™ï¼Œè¾¹ç¼˜é¢œè‰²å°†æ°¸è¿œæ˜¯ç›¸åŒçš„ã€‚å¦‚æœå®ƒæ˜¯â€™noneâ€™ï¼Œè¡¥ä¸è¾¹ç•Œä¸ä¼šè¢«ç”»ä¸‹æ¥ã€‚</p>
  </li>
  <li>
    <p><strong>alphaï¼šé€æ˜åº¦</strong></p>

    <p>[0,1]ï¼š1ä¸é€æ˜ï¼Œ0é€æ˜</p>
  </li>
  <li>
    <p><strong>cmapï¼šè‰²å½©ç›˜</strong></p>

    <p>å¯ä»¥ä½¿ç”¨é»˜è®¤çš„ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„ï¼Œå®ƒå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ª ä¸‰åˆ—çš„çŸ©é˜µ(æˆ–è€…è¯´ï¼Œshape ä¸º [N, 3]çš„ array )</p>

    <ul>
      <li>
        <p>çŸ©é˜µä¸­çš„å€¼ å–å€¼èŒƒå›´ ä¸º [0. , 1.]</p>
      </li>
      <li>
        <p>æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªé¢œè‰² (RGB)</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>linewidthsï¼šçº¿å®½</strong></p>

    <p>æ ‡è®°è¾¹ç¼˜çš„å®½åº¦ï¼Œé»˜è®¤æ˜¯â€™faceâ€™</p>
  </li>
  <li>
    <p>æ³¨æ„äº‹é¡¹ï¼š</p>

    <p>colorã€markerç­‰ä¸èƒ½åŒæ—¶ä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œplt.scatter(x1, y1, â€˜boâ€™, s=5)ä¸åˆæ³•ã€‚</p>
  </li>
</ul>

<h3 id="522-åŸºæœ¬ç”¨æ³•">5.2.2 åŸºæœ¬ç”¨æ³•</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
 
<span class="n">datafile</span> <span class="o">=</span> <span class="s">u'D:</span><span class="se">\\</span><span class="s">pythondata</span><span class="se">\\</span><span class="s">learn</span><span class="se">\\</span><span class="s">matplotlib.xlsx'</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="c1">#è®¾ç½®ç”»å¸ƒçš„å°ºå¯¸
</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Examples of scatter plots'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="c1">#æ ‡é¢˜ï¼Œå¹¶è®¾å®šå­—å·å¤§å°
</span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">u'x-year'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span><span class="c1">#è®¾ç½®xè½´ï¼Œå¹¶è®¾å®šå­—å·å¤§å°
</span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">u'y-income'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span><span class="c1">#è®¾ç½®yè½´ï¼Œå¹¶è®¾å®šå­—å·å¤§å°
</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">'æ—¶é—´'</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="s">'æ”¶å…¥_Jay'</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'deeppink'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">'æ—¶é—´'</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="s">'æ”¶å…¥_JJ'</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'darkblue'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">'+'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">'æ—¶é—´'</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="s">'æ”¶å…¥_Jolin'</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'goldenrod'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">'*'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'Jay income'</span><span class="p">,</span> <span class="s">'JJ income'</span><span class="p">,</span> <span class="s">'Jolin income'</span><span class="p">])</span><span class="c1">#æ ‡ç­¾
</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span><span class="c1">#æ˜¾ç¤ºå›¾åƒ
</span></code></pre></div></div>

<p><img src="/assets/images/posts/2019-08-05-schap6/1.png" alt="" /></p>

<h2 id="53-logistic-å›å½’åˆ†ç±»">5.3 Logistic å›å½’åˆ†ç±»</h2>

<h3 id="531-ç†è®ºæ¨å¯¼è¿‡ç¨‹">5.3.1 ç†è®ºæ¨å¯¼è¿‡ç¨‹</h3>

<p>å³ Logistic æ‹Ÿåˆï¼Œä¹Ÿå°±æ˜¯ç”¨ $wx$ æ‹Ÿåˆå¯¹æ•°å‡ ç‡å€¼ï¼Œç”¨æ•°å­¦å¼è¡¨ç¤ºä¸ºï¼š$ w \cdot x = \log \dfrac{p}{1-p}$</p>

<p>äºæ˜¯åè§£å‡º Logistic å›å½’æ¨¡å‹ï¼š</p>

<script type="math/tex; mode=display">p = \dfrac{e^{wx}}{1 + e^{wx}} = P(Y = 1 \mid x)</script>

<script type="math/tex; mode=display">1 - p = \dfrac{1}{1 + e^{wx}} = P(Y = 0 \mid x)</script>

<p>åªè¦æ±‚å‡º $w$ å°±æœ‰äº†æ¨¡å‹ï¼Œç„¶åå¯¹äºæ–°çš„ $x$ï¼Œæ±‚å‡ºå¯¹åº”çš„ $P(Y=1 \mid x)$ï¼Œå½“ $P(Y=1 \mid x) &gt; 0.5$ æ—¶ï¼Œåˆ¤å®šåˆ†ç±»ä¸º 1</p>

<p>è¦æ±‚å‡º $w$ ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¼¼ç„¶å‡½æ•° $L(w \mid X)$ï¼Œå¹¶ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡å‡†åˆ™é€‰å‡º Logistic å›å½’æ¨¡å‹çš„å‚æ•°</p>

<ul>
  <li>
    <p>ä¼¼ç„¶å‡½æ•°ï¼š</p>

    <script type="math/tex; mode=display">L(w) = \prod\limits_{i=1}^N \pi(x)^{y_i} [1 - \pi(x)]^{(1-y_i)}</script>
  </li>
  <li>
    <p>å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š</p>

    <script type="math/tex; mode=display">\log L(w) = \sum\limits_{i=1}^N (y_i \log h(x_i) + (1-y_i)\log (1-h(x_i)))</script>
  </li>
  <li>
    <p>æœ€å¤§ä¼¼ç„¶ä¼°è®¡å‡†åˆ™ï¼š</p>

    <script type="math/tex; mode=display">\min\limits_w (-log L(w))</script>
  </li>
  <li>
    <p>æ¢¯åº¦ä¸‹é™</p>

    <script type="math/tex; mode=display">% <![CDATA[
\begin{aligned} - \nabla f(w) &= - \nabla \left(\sum\limits_{i=1}^N (y_i \log h(x_i) + (1-y_i)\log (1-h(x_i)))\right)  \\ &= \sum\limits_{i=1}^N \left(h(x_i) - y_i \right)x_i  \\ w_{k+1} &= w_k - \alpha \sum\limits_{i=1}^N \left(h_w(x_i) - y_i \right)x_i  \end{aligned} %]]></script>
  </li>
</ul>

<h3 id="532-ä¼°è®¡æ¨¡å‹å‚æ•°">5.3.2 ä¼°è®¡æ¨¡å‹å‚æ•°</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">pred</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
    <span class="n">logit</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">logit</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">grad_descent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">pred</span> <span class="o">-</span> <span class="n">labels</span> <span class="c1"># å…¬å¼æ±‚å‡º
</span>        <span class="n">grad</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">grad</span>
    <span class="k">return</span> <span class="n">w</span>

<span class="k">def</span> <span class="nf">plot_line</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">data_list</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">()</span>
    <span class="n">plot_dataset</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">grad_descent</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">plot_line</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/assets/images/posts/2019-08-05-schap6/3.png" alt="" /></p>

<h3 id="532-é¢„æµ‹æ–°æ•°æ®æ‰€å±ç±»åˆ«">5.3.2 é¢„æµ‹æ–°æ•°æ®æ‰€å±ç±»åˆ«</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_cls</span> <span class="o">=</span> <span class="n">pred</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="6-è¡¥å……">6 è¡¥å……</h1>

<h2 id="61-ä»€ä¹ˆæ˜¯ä¼¼ç„¶">6.1 ä»€ä¹ˆæ˜¯ä¼¼ç„¶</h2>

<p>ä¼¼ç„¶æ˜¯ä¼¼ç„¶å‡½æ•°çš„ç®€ç§°</p>

<ul>
  <li>
    <p>å®šä¹‰</p>

    <p>è®¾æ€»ä½“ X æœä»åˆ†å¸ƒ $P(x;Î¸)$ï¼ˆå½“Xæ˜¯è¿ç»­å‹éšæœºå˜é‡æ—¶ä¸ºæ¦‚ç‡å¯†åº¦ï¼Œå½“Xä¸ºç¦»æ•£å‹éšæœºå˜é‡æ—¶ä¸ºæ¦‚ç‡åˆ†å¸ƒï¼‰ï¼ŒÎ¸ä¸ºå¾…ä¼°å‚æ•°ï¼Œ$X_1,X_2,â€¦X_n$ æ˜¯æ¥è‡ªäºæ€»ä½“ X çš„æ ·æœ¬ï¼Œ$x_1,x_2â€¦x_n$ ä¸ºæ ·æœ¬ $X_1,X_2,â€¦X_n$ çš„ä¸€ä¸ªè§‚å¯Ÿå€¼ï¼Œåˆ™æ ·æœ¬çš„è”åˆåˆ†å¸ƒï¼ˆå½“Xæ˜¯è¿ç»­å‹éšæœºå˜é‡æ—¶ä¸ºæ¦‚ç‡å¯†åº¦ï¼Œå½“Xä¸ºç¦»æ•£å‹éšæœºå˜é‡æ—¶ä¸ºæ¦‚ç‡åˆ†å¸ƒï¼‰ã€€$L(Î¸) = P(x_1,x_2,â€¦,x_n;Î¸)= \prod P(x_i;Î¸) $ ç§°ä¸ºä¼¼ç„¶å‡½æ•°ï¼Œå…¶ä¸­Î¸æ˜¯ä¸€ä¸ªåˆ—å‘é‡</p>
  </li>
  <li>
    <p>ç™¾åº¦</p>

    <p>ä¼¼ç„¶æ˜¯å¯¹ likelihood çš„ç¿»è¯‘ï¼Œå³â€œå¯èƒ½æ€§â€</p>
  </li>
  <li>
    <p>å…¶ä»–</p>

    <ul>
      <li>
        <p>åœ¨é¢‘ç‡æ¨è®ºä¸­ï¼Œä¼¼ç„¶å‡½æ•°ï¼ˆç®€ç§°ä¼¼ç„¶ï¼‰æ˜¯ä¸€ä¸ªåœ¨ç»™å®šäº†æ•°æ®çš„æƒ…å†µä¸‹ï¼Œå…³äºæ¨¡å‹å‚æ•°çš„å‡½æ•°</p>
      </li>
      <li>
        <p>åœ¨æ•°ç†ç»Ÿè®¡ä¸­ï¼Œæ¦‚ç‡æè¿°çš„æ˜¯ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿçš„å¯èƒ½æ€§ï¼›ä¼¼ç„¶æè¿°çš„æ˜¯ç»™å®šäº†ç»“æœä¹‹åï¼Œæ¨¡å‹å‚æ•°ä¸ºæŸä¸ªå€¼çš„å¯èƒ½æ€§ã€‚</p>
      </li>
      <li>
        <p>$p(x \mid \theta)$ æ˜¯æœ‰ç€ä¸¤ä¸ªå˜é‡çš„å‡½æ•°ï¼Œå°† $\theta$ è®¾ä¸ºå¸¸æ•°å°±å¾—åˆ°ä¸€ä¸ªæ¦‚ç‡å‡½æ•°ï¼ˆå…³äº x çš„å‡½æ•°ï¼‰ï¼›å°† x è®¾ä¸ºå¸¸æ•°ï¼Œå°±å¾—åˆ°ä¼¼ç„¶å‡½æ•°ï¼ˆå…³äº $\theta$ çš„å‡½æ•°ï¼‰$L( \theta \mid x)$ã€‚å½“ç»“æœä¸å‚æ•°ç›¸å¯¹åº”æ—¶ï¼Œä¼¼ç„¶ä¸æ¦‚ç‡åœ¨æ•°å€¼ä¸Šæ˜¯ç›¸ç­‰çš„</p>
      </li>
      <li>
        <p>$p(x \mid \theta)$ å¦‚æœ $\theta$ å·²çŸ¥ï¼Œåˆ™æ˜¯æ¦‚ç‡å‡½æ•°ï¼Œå®ƒæè¿°çš„æ˜¯å¯¹äºä¸åŒçš„ xï¼Œå‡ºç°çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼›å¦‚æœ $x$ å·²çŸ¥ï¼Œ$\theta$ æœªçŸ¥ï¼Œåˆ™æ˜¯ä¼¼ç„¶å‡½æ•°ï¼Œå®ƒæè¿°çš„æ˜¯åœ¨ç›¸åŒ x ä¸‹ï¼Œæ‰€å±ä¸åŒ $\theta$ çš„æ¦‚ç‡</p>
      </li>
      <li>
        <p>æ¦‚ç‡å’Œä¼¼ç„¶çš„åŒºåˆ«:</p>

        <ul>
          <li>
            <p>æ¦‚ç‡ï¼Œæ˜¯åœ¨å·²çŸ¥æ¦‚ç‡åˆ†å¸ƒå‚æ•°çš„æƒ…å†µä¸‹ï¼Œé¢„æµ‹ç»“æœ;</p>
          </li>
          <li>
            <p>ä¼¼ç„¶åˆ™æ˜¯ç”¨äºåœ¨å·²çŸ¥ç»“æœæ—¶ï¼Œå¯¹ç»“æœæ‰€å±çš„æ¦‚ç‡åˆ†å¸ƒçš„å‚æ•°çš„ä¼°è®¡</p>
          </li>
        </ul>
      </li>
      <li>
        <p>å‡è®¾è§‚å¯Ÿåˆ° N ä¸ªæ•°æ® $X = {x_1, x_2, â€¦, x_N}$ï¼Œæˆ‘ä»¬å‡è®¾è¿™äº›æ•°æ®æ¥æºäº<strong>æ­£å¤ªåˆ†å¸ƒ</strong>ï¼Œè®¾å®š<strong>æ¦‚ç‡å¯†åº¦å‡½æ•°</strong>ä¸º $f(x; \mu, \delta)$ï¼Œé‚£ä¹ˆè¿™ç»„~æ•°æ®~åœ¨å‡è®¾çš„æ¦‚ç‡åˆ†å¸ƒä¸­~å‡ºç°çš„å¯èƒ½æ€§~å°±æ˜¯å®ƒä»¬æ¦‚ç‡çš„ä¹˜ç§¯ï¼š$P(X \mid \mu, \delta) = \prod\limits_{i=1}^N P(x_i \mid \mu, \delta) = L(\mu, \delta \mid X) $ï¼Œè¿™é‡Œæˆ‘ä»¬å« $L(\mu, \delta \mid X)$ ä¸ºä¼¼ç„¶å‡½æ•°ï¼Œå«ä¹‰æ˜¯å·²çŸ¥æ ·æœ¬ $X$ æ—¶ï¼Œå‚æ•° $\mu, \delta$ ä¸ºå„ç§å€¼çš„å¯èƒ½æ€§</p>
      </li>
    </ul>
  </li>
  <li>
    <p>æ€»ç»“</p>

    <ul>
      <li>
        <p>ä¼¼ç„¶ä¹Ÿç§°ä¼¼ç„¶å‡½æ•°ï¼Œæ˜¯ç»™å®šæ ·æœ¬ $X$ åï¼Œæ¨¡å‹å‚æ•°å–æŸä¸ªå€¼çš„æ¦‚ç‡</p>
      </li>
      <li>
        <p>ä¼¼ç„¶å‡½æ•°å†™ä½œï¼š$ L(\theta \mid X)$</p>
      </li>
    </ul>
  </li>
</ul>

:ET