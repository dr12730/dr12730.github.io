I"o<!-- vim-markdown-toc GFM -->

<ul>
  <li><a href="#1-ç¡¬é—´éš”æœ€å¤§åŒ–çš„çº¿æ€§æ”¯æŒå‘é‡æœº">1 ç¡¬é—´éš”æœ€å¤§åŒ–çš„çº¿æ€§æ”¯æŒå‘é‡æœº</a>
    <ul>
      <li><a href="#11-å¯¹å¶ç®—æ³•">1.1 å¯¹å¶ç®—æ³•</a></li>
      <li><a href="#12-æ€»ç»“">1.2 æ€»ç»“</a></li>
    </ul>
  </li>
  <li><a href="#2-è½¯é—´éš”æœ€å¤§åŒ–çš„çº¿æ€§æ”¯æŒå‘é‡æœº">2 è½¯é—´éš”æœ€å¤§åŒ–çš„çº¿æ€§æ”¯æŒå‘é‡æœº</a>
    <ul>
      <li><a href="#21-å­¦ä¹ ç®—æ³•çš„å¯¹å¶ç®—æ³•">2.1 å­¦ä¹ ç®—æ³•çš„å¯¹å¶ç®—æ³•</a></li>
      <li><a href="#22-æ€»ç»“">2.2 æ€»ç»“</a>
        <ul>
          <li><a href="#221-çº¿æ€§æ”¯æŒå‘é‡æœºå­¦ä¹ ç®—æ³•">2.2.1 çº¿æ€§æ”¯æŒå‘é‡æœºå­¦ä¹ ç®—æ³•ï¼š</a></li>
          <li><a href="#222-æ”¯æŒå‘é‡">2.2.2 æ”¯æŒå‘é‡</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#3-åºåˆ—æœ€å°æœ€ä¼˜åŒ–ç®—æ³•-smo">3 åºåˆ—æœ€å°æœ€ä¼˜åŒ–ç®—æ³• SMO</a>
    <ul>
      <li><a href="#31-æ±‚è§£ä¸¤ä¸ªå˜é‡äºŒæ¬¡è§„åˆ’é—®é¢˜çš„è§£ææ–¹æ³•">3.1 æ±‚è§£ä¸¤ä¸ªå˜é‡äºŒæ¬¡è§„åˆ’é—®é¢˜çš„è§£ææ–¹æ³•</a></li>
      <li><a href="#32-å˜é‡çš„é€‰æ‹©">3.2 å˜é‡çš„é€‰æ‹©</a></li>
      <li><a href="#33-è®¡ç®—é˜ˆå€¼-b-å’Œå·®å€¼-e_1">3.3 è®¡ç®—é˜ˆå€¼ b å’Œå·®å€¼ $E_1$</a>
        <ul>
          <li><a href="#331-æ›´æ–°-b-å€¼">3.3.1 æ›´æ–° b å€¼</a></li>
          <li><a href="#332-æ›´æ–°-e_1">3.3.2 æ›´æ–° $E_1$</a></li>
        </ul>
      </li>
      <li><a href="#34-smo-ç®—æ³•æµç¨‹">3.4 SMO ç®—æ³•æµç¨‹</a></li>
    </ul>
  </li>
  <li><a href="#4-ä»£ç å®æˆ˜">4 ä»£ç å®æˆ˜</a>
    <ul>
      <li><a href="#41-ç®€å•-svm-ç®—æ³•æ€è·¯">4.1 ç®€å• SVM ç®—æ³•æ€è·¯</a></li>
      <li><a href="#42-ä»£ç å®æˆ˜">4.2 ä»£ç å®æˆ˜</a></li>
      <li><a href="#43-æ‰§è¡Œç»“æœ">4.3 æ‰§è¡Œç»“æœ</a></li>
      <li><a href="#44-ä¼˜åŒ–çš„-smo-ç®—æ³•">4.4 ä¼˜åŒ–çš„ SMO ç®—æ³•</a></li>
      <li><a href="#45-å®æˆ˜ä»£ç ">4.5 å®æˆ˜ä»£ç </a></li>
      <li><a href="#46-æ‰§è¡Œç»“æœ">4.6 æ‰§è¡Œç»“æœ</a></li>
    </ul>
  </li>
</ul>

<!-- vim-markdown-toc -->

<h2 id="1-ç¡¬é—´éš”æœ€å¤§åŒ–çš„çº¿æ€§æ”¯æŒå‘é‡æœº">1 ç¡¬é—´éš”æœ€å¤§åŒ–çš„çº¿æ€§æ”¯æŒå‘é‡æœº</h2>

<p>æ”¯æŒå‘é‡æœºæ˜¯ä¸€ç§åˆ†ç±»æ¨¡å‹ï¼Œå®ƒå¯ä»¥åœ¨<strong>çº¿æ€§å¯åˆ†çš„æ•°æ®</strong>ä¸­æ‰¾åˆ°ä¸€ä¸ªè¶…å¹³é¢ï¼ŒæŠŠæ•°æ®åˆ†æˆä¸¤ç±»ã€‚åœ¨è¶…å¹³é¢ä¸€ä¾§çš„æ•°æ®ä¸ºæ­£ç±»ï¼Œå¦ä¸€ä¾§çš„ä¸ºè´Ÿç±»ã€‚</p>

<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æ‹¿åˆ°æ•°æ®é›† $D = {(x_1, y_1), (x_2, y_2), â€¦, (x_n, y_n)}$ï¼Œæ€ä¹ˆæ‰¾è¶…å¹³é¢å‘¢ï¼Ÿ</p>

<p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰è¶…å¹³é¢çš„æ–¹ç¨‹ä¸º $w^T \cdot x + b = 0$ï¼Œç®€å†™æˆ $(w, b)$ ã€‚é‚£ä¹ˆï¼Œæ•°æ®é›†ä¸­çš„æ ·æœ¬ $(x_i, y_i)$ åˆ°è¿™ä¸ªå¹³é¢çš„è·ç¦»å¯ä»¥è¡¨ç¤ºæˆï¼š $\dfrac{y_i(w^T \cdot x_i + b)}{\parallel w \parallel}$ ã€‚æ”¯æŒå‘é‡æœºçš„æ€æƒ³æ˜¯è®©æ”¯æŒå‘é‡åˆ°è¶…å¹³é¢çš„è·ç¦»å°½å¯èƒ½å¤§ï¼Œè€Œæ”¯æŒå‘é‡å°±æ˜¯åˆ°è¶…å¹³é¢è·ç¦»æœ€å°çš„æ ·æœ¬ç‚¹ï¼Œå³ $\mathop{\arg\min}\limits_{i} \dfrac{y_i(w^T \cdot x_i + b)}{\parallel w \parallel}$ å¾—åˆ°çš„å„ä¸ªæ ·æœ¬ $(x_i, y_i)$ã€‚ç„¶åå†é€‰å–è¶…å¹³é¢ $(w, b)$ è®©è¿™ä¸ªè·ç¦»æœ€å¤§ï¼Œå³ï¼š</p>

<script type="math/tex; mode=display">\mathop{\arg\max}\limits_{(w, b)}\left[\min\limits_{i} \dfrac{y_i(w^T \cdot x_i + b)}{\parallel w \parallel} \right]</script>

<p>æ±‚å‡ºä¸Šé¢çš„ $(w, b)$ å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„è¶…å¹³é¢ã€‚</p>

<p>ä¸‹é¢å°±æ˜¯æ±‚è§£çš„è¿‡ç¨‹ã€‚</p>

<p>æˆ‘ä»¬çŸ¥é“ï¼Œ $y_i(w^T \cdot x_i + b) \ge 1$ è€Œä¸”åªæœ‰æ”¯æŒå‘é‡æ‰èƒ½å–åˆ° 1ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠä¸Šå¼å†™æˆï¼š</p>

<script type="math/tex; mode=display">\mathop{\arg\max}\limits_{(w, b)}\left[\min\limits_{i} \dfrac{1}{\parallel w \parallel} \right] = \mathop{\arg\max}\limits_{(w, b)} \dfrac{1}{\parallel w \parallel} = \mathop{\arg\min}\limits_{(w, b)}\parallel w \parallel = \dfrac{1}{2}\mathop{\arg\min}\limits_{(wb)} \parallel w \parallel^2</script>

<p>è¿™å°±æ˜¯ SVM å­¦ä¹ çš„æœ€ä¼˜åŒ–é—®é¢˜ã€‚æ•´ç†ä¸€ä¸‹å°±æ˜¯ï¼š</p>

<p>å¯¹äºä¸€ä¸ªè®­ç»ƒæ•°æ®é›† $D = {(x_1, y_1), (x_2, y_2), â€¦, (x_n, y_n)}$ï¼Œè¦å¾—åˆ°æœ€å¤§åˆ†éš”è¶…å¹³é¢å’Œåˆ†ç±»å†³ç­–å‡½æ•°ã€‚</p>

<p>å°±æ˜¯è¦æ±‚æœ€ä¼˜åŒ–é—®é¢˜ï¼š</p>

<script type="math/tex; mode=display">\mathop{\arg\min}\limits_{(w, b)} \dfrac{1}{2} \parallel w \parallel^2 \tag{1.1}</script>

<p>çº¦æŸæ¡ä»¶ï¼š</p>

<script type="math/tex; mode=display">y_i(w^T \cdot x_i + b) - 1 \ge 0 \tag{1.2}</script>

<p>æ±‚å‡ºåå¾—åˆ°æœ€å¤§åˆ†éš”è¶…å¹³é¢ï¼š</p>

<script type="math/tex; mode=display">w^\ast \cdot x + b^\ast = 0 \tag{1.3}</script>

<p>åˆ†ç±»å†³ç­–å‡½æ•°ï¼š</p>

<script type="math/tex; mode=display">f(x) = sign(w^\ast \cdot x + b^\ast) \tag{1.4}</script>

<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®é™…ä¾‹å­ï¼š</p>

<p>å¯¹äºä¸€ä¸ªè®­ç»ƒæ•°æ®é›†ï¼Œå…¶æ­£æ ·æœ¬ç‚¹æ˜¯ $x_1 = (3, 3)^T, x_2 = (4, 3)^{T}$ ï¼Œè´Ÿæ ·æœ¬ç‚¹æ˜¯ $x_3 = (1, 1)^{T}$ ï¼Œå¦‚ä½•æ‰¾åˆ°æœ€å¤§é—´éš”åˆ†ç¦»è¶…å¹³é¢ï¼Ÿ</p>

<p>å› ä¸ºæœ€å¤§åˆ†éš”è·ç¦»è·Ÿ $\dfrac{1}{\parallel w \parallel}$ æœ‰å…³ï¼Œæ‰€ä»¥å€’è¿‡æ¥æœ€å¤§å˜æˆæœ€å°ï¼Œå¾—åˆ° $\mathop{\arg\min}\limits_{(w, b)} \dfrac{1}{2} \parallel w \parallel ^2$</p>

<p>å¯¹äºæœ¬é¢˜ï¼š</p>

<script type="math/tex; mode=display">\mathop{\arg\min}\limits_{(w, b)} \dfrac{1}{2} \parallel w \parallel^2 = \mathop{\arg\min}\limits_{(w, b)} \dfrac{1}{2} (w_1^2 + w_2^2)</script>

<p>çº¦æŸæ¡ä»¶ä¸ºï¼š$y_i(w^T \cdot x_i + b) \ge 1$ï¼Œæ‰€ä»¥ï¼š</p>

<script type="math/tex; mode=display">1 \cdot (3w_1 + 3w_2 + b) \ge 1</script>

<script type="math/tex; mode=display">1 \cdot (4w_1 + 3w_2 + b) \ge 1</script>

<script type="math/tex; mode=display">-1 \cdot (w_1 + w_2 + b) \ge 1</script>

<p>åœ¨çº¦æŸæ¡ä»¶ä¸‹å°±å‡ºæœ€ä¼˜åŒ–é—®é¢˜çš„è§£ï¼š$w_1 = w_2 = \dfrac{1}{2}, b = -2$ ï¼Œæ‰€ä»¥åˆ†éš”è¶…å¹³é¢ä¸ºï¼š</p>

<script type="math/tex; mode=display">\dfrac{1}{2} x^{(1)} + \dfrac{1}{2} x^{(2)} - 2 = 0</script>

<p>å…¶ä¸­ï¼Œ$x_1 = (3, 3)^T, x_3 = (1, 1)^T$ ä¸ºæ”¯æŒå‘é‡</p>

<h3 id="11-å¯¹å¶ç®—æ³•">1.1 å¯¹å¶ç®—æ³•</h3>

<p>SVM æœ€ä¼˜åŒ–é—®é¢˜ï¼š</p>

<script type="math/tex; mode=display">\mathop{\arg\min}\limits_{(w, b)} \dfrac{1}{2} \parallel w \parallel^2 \tag{1.5}</script>

<p>çº¦æŸæ¡ä»¶ï¼š</p>

<script type="math/tex; mode=display">y_i(w^T \cdot x_i + b) - 1 \ge 0 \tag{1.6}</script>

<p>è¿™ä¸ª SVM æœ€ä¼˜åŒ–é—®é¢˜çš„æ±‚è§£ï¼Œè¦å…ˆç¡®å®šçº¦æŸæ¡ä»¶çš„èŒƒå›´ï¼Œç„¶ååœ¨èŒƒå›´ä¸­æ‰¾æœ€å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡ä¸€ä¸ªå¼å­æŠŠæœ€å€¼å’Œçº¦æŸæ¡ä»¶éƒ½åŒ…å«è¿›æ¥ï¼Œè¿™å°±æ˜¯æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ³•ã€‚æˆ‘ä»¬å¼•å…¥æ‹‰æ ¼æœ—æ—¥ä¹˜å­ $\alpha_i \ge 0, i = 1, 2, â€¦, N$ æ„é€ æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š</p>

<script type="math/tex; mode=display">L(w, b, \alpha) = \dfrac{1}{2} \parallel w \parallel^2 - \sum\limits_{i=1}^{N} \alpha_i \left[ y_i(w^T \cdot x_i + b) - 1\right]</script>

<p>å†æœ‰æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§åŸç†ï¼ŒåŸå§‹é—®é¢˜çš„å¯¹å¶é—®é¢˜æ˜¯æå¤§æå°é—®é¢˜ï¼š</p>

<script type="math/tex; mode=display">\mathop{\arg\max}\limits_{\alpha} \left[ \mathop{\arg\min}\limits_{(w, b)} L(w, b, \alpha)\right]</script>

<p>å¯¹äº $\mathop{\arg\min}\limits_{(w, b)}$ çš„éƒ¨åˆ†ï¼Œåªè¦æ±‚ $\dfrac{\partial L}{\partial w}$ å’Œ $\dfrac{\partial L}{\partial b}$ å°±å¯ä»¥äº†ï¼Œäºæ˜¯æœ‰ï¼š</p>

<script type="math/tex; mode=display">\dfrac{\partial L}{\partial w} = w - \sum\limits_{i=1}^{N} \alpha_i y_i x_i = 0</script>

<script type="math/tex; mode=display">\dfrac{\partial L}{\partial b} = \sum\limits_{i=1}^{N} \alpha_i y_i = 0</script>

<p>è¿™æ ·æ±‚å‡º $w^* = \sum\limits_{i=1}^{N} \alpha_i y_i x_i$ï¼Œ åœ¨å¸¦å…¥ $L(w, b, \alpha)$ å°±å¯ä»¥å¾—åˆ°ï¼š</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned} & \mathop{\arg\max}\limits_{\alpha} \left\{ \dfrac{1}{2} \left(\sum\limits_{i=1}^{N} \alpha_iy_ix_i \right)^2 - \sum\limits_{i=1}^{N} \alpha_i \left[ y_i\left((\sum\limits_{j=1}^{N} \alpha_jy_jx_j) \cdot x_i + b\right) - 1 \right] \right\} \\ &= \mathop{\arg\max}\limits_{\alpha}\dfrac{1}{2} \sum\limits_{i=1}^{N} \sum\limits_{j=1}^{N} \alpha_i \alpha_j y_iy_j x_ix_j - \sum\limits_{i=1}^{N} \sum\limits_{j=1}^{N} \alpha_i \alpha_j y_iy_j x_ix_j + b \cdot \sum\limits_{i=1}^{N} \alpha_iy_i + \sum\limits_{i=1}^{N} \alpha_i \end{aligned} %]]></script>

<p>åˆå› ä¸º $b \cdot \sum\limits_{i=1}^{N} \alpha_iy_i = b\cdot 0 = 0$ ï¼Œæ‰€ä»¥ï¼š</p>

<script type="math/tex; mode=display">\mathop{\arg\min}\limits_{(w, b)} L(w, b, \alpha) = - \dfrac{1}{2} \sum\limits_{i=1}^{N} \sum\limits_{j=1}^{N} \alpha_i \alpha_j y_iy_j (x_i \cdot x_j) + \sum\limits_{i=1}^{N} \alpha_i</script>

<p>é‚£ä¹ˆåŸå§‹é—®é¢˜çš„å¯¹å¶é—®é¢˜å°±æ˜¯ï¼š</p>

<script type="math/tex; mode=display">\mathop{\arg\max}\limits_{\alpha} \left[ \mathop{\arg\min}\limits_{(w, b)} L(w, b, \alpha)\right] = \mathop{\arg\max}\limits_{\alpha} \left\{ - \dfrac{1}{2} \sum\limits_{i=1}^{N} \sum\limits_{j=1}^{N} \alpha_i \alpha_j y_iy_j (x_i \cdot x_j) + \sum\limits_{i=1}^{N} \alpha_i \right\}</script>

<p>åŠ ä¸Šè´Ÿå·ï¼Œæœ€å¤§å˜æœ€å°ï¼š</p>

<script type="math/tex; mode=display">\mathop{\arg\min}\limits_{\alpha} \left\{ \dfrac{1}{2} \sum\limits_{i=1}^{N} \sum\limits_{j=1}^{N} \alpha_i \alpha_j y_iy_j (x_i \cdot x_j) - \sum\limits_{i=1}^{N} \alpha_i \right\} \tag{1.7}</script>

<p>çº¦æŸæ¡ä»¶ï¼š</p>

<script type="math/tex; mode=display">\sum\limits_{i=1}^{N} \alpha_iy_i = 0 \tag{1.8}</script>

<script type="math/tex; mode=display">\alpha_i \ge 0 \tag{1.9}</script>

<p>ä¸Šé¢å°±æ˜¯å¯¹å¶æœ€ä¼˜åŒ–é—®é¢˜ã€‚</p>

<p>å½“æˆ‘ä»¬æ±‚å‡ºæœ€ä¼˜è§£ $\alpha^{\ast} = (\alpha_1^{\ast}, \alpha_2^{\ast}, \dots, \alpha_N^{\ast})$ åï¼Œå¯ä»¥è®¡ç®—ï¼š</p>

<script type="math/tex; mode=display">w^* = \sum\limits_{i=1}^{N} \alpha_i^* y_i x_i \tag{1.10}</script>

<p>å†é€‰å‡ºå…¶ä¸­çš„ä¸€ä¸ªæ­£åˆ†é‡ $\alpha_{j}^{\ast} &gt; 0$ï¼Œè®¡ç®—ï¼š</p>

<script type="math/tex; mode=display">b^* = y_j - \sum\limits_{i=1}^{N} \alpha_i^* y_i (x_i \cdot x_j) \tag{1.11}</script>

<p>å› ä¸ºå¯¹æ­¤ $j$ æœ‰ï¼š</p>

<script type="math/tex; mode=display">y_j(w^* \cdot x_j + b^*) - 1 = 0</script>

<p>æŠŠ $w^*$ ä»£å…¥ï¼Œå¹¶ä¸”æœ‰ $y_j^2 = 1$ï¼Œæ‰€ä»¥ç»“æœå¦‚ $\eqref{1.11}$ æ‰€ç¤º</p>

<h3 id="12-æ€»ç»“">1.2 æ€»ç»“</h3>

<p>å¯¹äºç»™å®šçš„è®­ç»ƒæ•°æ®é›†ï¼Œå¯ä»¥å…ˆæ±‚å‡ºå¯¹å¶é—®é¢˜çš„ $\alpha^{\ast}$ï¼Œå†æ±‚ $(w^{\ast}, b^{\ast})$ï¼Œä»è€Œå¾—åˆ°åˆ†éš”è¶…å¹³é¢ä»¥åŠåˆ†ç±»å†³ç­–å‡½æ•°ã€‚è¿™ç§ç®—æ³•ç§°ä¸º<strong>æ”¯æŒå‘é‡æœºçš„å¯¹å¶å­¦ä¹ ç®—æ³•</strong></p>

<h2 id="2-è½¯é—´éš”æœ€å¤§åŒ–çš„çº¿æ€§æ”¯æŒå‘é‡æœº">2 è½¯é—´éš”æœ€å¤§åŒ–çš„çº¿æ€§æ”¯æŒå‘é‡æœº</h2>

<p>ä¸Šé¢çš„æ”¯æŒå‘é‡æœºå­¦ä¹ ç®—æ³•åªé’ˆå¯¹äº<strong>çº¿æ€§å¯åˆ†æ•°æ®</strong>ï¼Œå¯¹äºçº¿æ€§ä¸å¯åˆ†çš„æ•°æ®ï¼Œå› ä¸ºä¸Šé¢çš„çº¦æŸæ¡ä»¶ä¸æˆç«‹ï¼Œæ‰€ä»¥ä¸é€‚ç”¨ã€‚</p>

<blockquote>
  <p>è¿™é‡Œçš„çº¿æ€§ä¸å¯åˆ†æ•°æ®åº”è¯¥è§£é‡Šä¸ºï¼šæ•°æ®ä¸­å­˜åœ¨å°‘è®¸ç‰¹å¼‚æ ·æœ¬ç‚¹ï¼Œé™¤å»è¿™äº›å¤–çš„æ•°æ®é›†æ˜¯çº¿æ€§å¯åˆ†çš„ã€‚</p>
</blockquote>

<p>çº¿æ€§ä¸å¯åˆ†æ„å‘³ç€å¯¹äºç‰¹å¼‚æ ·æœ¬ç‚¹ $(x_i, y_i)$ å®ƒä¸æ»¡è¶³ $y_i(w^T \cdot x_i + b) \ge 1$ã€‚æˆ‘ä»¬å¯ä»¥è®©å®ƒåŠ ä¸Šä¸€ä¸ªæ¾å¼›å˜é‡ $\xi_i$ï¼Œä½¿ $y_i(w^T \cdot x_i + b) + \xi_i \ge 1$ï¼Œè¿™å°±æ˜¯è½¯é—´éš”ã€‚å¤šå¢åŠ çš„æ¾å¼›å˜é‡ï¼Œä¹Ÿéœ€è¦ç»™å‡ºä»£ä»·ï¼Œæ‰€ä»¥ä¼˜åŒ–ç›®æ ‡å˜ä¸º $\dfrac{1}{2} \parallel w \parallel^2 + C \sum\limits_{i=1}^{N} \xi_i$ ã€‚è¿™é‡Œæˆ‘ä»¬ç»™æ¯ä¸€ä¸ªæ ·æœ¬éƒ½åŠ ä¸Šäº†ä¸€ä¸ªæ¾å¼›å˜é‡ã€‚</p>

<p>è¿™æ ·ï¼Œè½¯é—´éš”æœ€å¤§åŒ–çš„çº¿æ€§æ”¯æŒå‘é‡æœºå­¦ä¹ ç®—æ³•è½¬åŒ–ä¸ºå‡¸ä¼˜åŒ–äºŒæ¬¡é—®é¢˜ï¼ˆåŸå§‹é—®é¢˜ï¼‰</p>

<script type="math/tex; mode=display">\mathop{\arg\min}\limits_{w, b, \xi} \left[\dfrac{1}{2} \parallel w \parallel^2 + C \sum\limits_{i=1}^{N} \xi_i \right] \tag{2.1}\label{2.1}</script>

<p>s.tï¼š</p>

<script type="math/tex; mode=display">y_i(w^T \cdot x_i + b) + \xi_i \ge 1 \tag{2.2}\label{2.2}</script>

<script type="math/tex; mode=display">\xi_i \ge 0 \tag{2.3}\label{2.3}</script>

<blockquote>
  <p>æœ€å°åŒ–ç›®æ ‡å‡½æ•° $\eqref{2.1}$ åŒ…å«ä¸¤å±‚å«ä¹‰ï¼šä½¿ $\dfrac{1}{2} \parallel w \parallel ^2$ å°½å¯èƒ½å°å³é—´éš”å°½å¯èƒ½å¤§ï¼ŒåŒæ—¶è®©è½åœ¨åˆ†éš”åŒºçš„ç‰¹å¼‚æ ·æœ¬å°½å¯èƒ½å°‘ï¼ˆè¯¯åˆ†ç±»ç‚¹å°½å¯èƒ½å°‘ï¼‰ï¼ŒC è°ƒå’Œä¸¤è€…çš„ç³»æ•°</p>
</blockquote>

<p>é€šè¿‡å­¦ä¹ ç®—æ³•å³è½¯é—´éš”æœ€å¤§åŒ–ï¼Œå¯ä»¥æ‰¾åˆ° $(w^{\ast}, b^{\ast})$ ï¼Œä»è€Œå¾—åˆ°åˆ†ç¦»è¶…å¹³é¢å’Œåˆ†ç±»å†³ç­–å‡½æ•°ã€‚åˆ†ç¦»è¶…å¹³é¢å’Œç›¸åº”çš„åˆ†ç±»å†³ç­–å‡½æ•°ä¸€èµ·ï¼Œå°±æˆä¸ºçº¿æ€§æ”¯æŒå‘é‡æœº</p>

<h3 id="21-å­¦ä¹ ç®—æ³•çš„å¯¹å¶ç®—æ³•">2.1 å­¦ä¹ ç®—æ³•çš„å¯¹å¶ç®—æ³•</h3>

<p>åŸå§‹é—®é¢˜  $\eqref{2.1}, \eqref{2.2}, \eqref{2.3}$ çš„å¯¹å¶é—®é¢˜å¦‚ä¸‹ï¼š</p>

<script type="math/tex; mode=display">\mathop{\arg\min}\limits_{\alpha} \left\{ \dfrac{1}{2} \sum\limits_{i=1}^{N} \sum\limits_{j=1}^{N} \alpha_i \alpha_j y_iy_j (x_i \cdot x_j) - \sum\limits_{i=1}^{N} \alpha_i \right\} \tag{2.4}\label{2.4}</script>

<p>s.t.</p>

<script type="math/tex; mode=display">\sum\limits_{i=1}^{N} a_iy_i =0 \tag{2.5}\label{2.5}</script>

<script type="math/tex; mode=display">0 \le \alpha_i \le C \tag{2.6}\label{2.6}</script>

<p>é€šè¿‡æ±‚è§£ä¸Šå¼å¯ä»¥å¾—åˆ°è§£ $\alpha^{\ast} = (\alpha_1^{\ast}, \alpha_2^{\ast}, \dots, \alpha_N^{\ast})^T$ï¼Œå–ä¸€ä¸ªåˆ†é‡ $0 \le \alpha_j^{\ast} \le C$ ï¼Œæ±‚å‡º $(w^{\ast}, b^{\ast})$ ï¼š</p>

<script type="math/tex; mode=display">w^{*} = \sum\limits_{i=1}^{N} \alpha_i^{*} y_i x_i \tag{2.7}\label{2.7}</script>

<script type="math/tex; mode=display">b^{*} = y_j - \sum\limits_{i=1}^{N} y_i \alpha_i^{*} (x_i \cdot x_j) \tag{2.8}\label{2.8}</script>

<h3 id="22-æ€»ç»“">2.2 æ€»ç»“</h3>

<h4 id="221-çº¿æ€§æ”¯æŒå‘é‡æœºå­¦ä¹ ç®—æ³•">2.2.1 çº¿æ€§æ”¯æŒå‘é‡æœºå­¦ä¹ ç®—æ³•ï¼š</h4>

<p><strong>è¾“å…¥</strong>ï¼šè®­ç»ƒæ•°æ®é›† $D = {(x_1, y_1), (x_2, y_2), â€¦, (x_N, y_N)}$</p>

<p><strong>è¾“å‡º</strong>ï¼šåˆ†ç¦»è¶…å¹³é¢å’Œåˆ†ç±»å†³ç­–å‡½æ•°</p>

<ol>
  <li>
    <p>é€‰æ‹©æƒ©ç½šå‚æ•° C &gt; 0ï¼Œæ„é€ å¹¶æ±‚è§£å‡¸äºŒæ¬¡ä¼˜åŒ–é—®é¢˜ï¼š $\eqref{2.4}, \eqref{2.5}, \eqref{2.6}$</p>

    <p>æ±‚å¾—æœ€ä¼˜è§£ $\alpha^{\ast} = (\alpha_1^{\ast}, \alpha_2^{\ast}, \dots, \alpha_N^{\ast})^T$</p>
  </li>
  <li>
    <p>è®¡ç®— $\eqref{2.7}$</p>

    <p>é€‰æ‹© $\alpha^{\ast}$ çš„ä¸€ä¸ªåˆ†é‡ $\alpha^{\ast}_j$ è®¡ç®— $\eqref{2.8}$</p>
  </li>
  <li>
    <p>æ±‚å¾—åˆ†ç¦»è¶…å¹³é¢ $w^{\ast} \cdot x + b^{\ast} = 0$</p>

    <p>åˆ†ç±»å†³ç­–å‡½æ•°ï¼š $f(x) = sign(w^{\ast} \cdot x + b^{\ast})$</p>
  </li>
</ol>

<h4 id="222-æ”¯æŒå‘é‡">2.2.2 æ”¯æŒå‘é‡</h4>

<p>åœ¨çº¿æ€§ä¸å¯åˆ†çš„æƒ…å†µä¸‹ï¼Œè§£ $\alpha_{\ast} = (\alpha_1^{\ast}, \alpha_2^{\ast}, \dots, \alpha_N^{\ast})^T$ ä¸­å¯¹åº”äº $\alpha_i^{\ast} \gt 0$ çš„æ ·æœ¬ç‚¹ $(x_i, y_i)$ æˆä¸ºæ”¯æŒå‘é‡ã€‚</p>

<p>å› ä¸º KKT æ¡ä»¶æœ‰ï¼š</p>

<script type="math/tex; mode=display">\alpha_i^{\ast} \bigg[ y_i (w^{\ast} \cdot x_i + b^{\ast}) - 1 + \zeta_i^{\ast} \bigg] = 0</script>

<p>å½“ $\alpha_i^{\ast} &gt; 0$ æ—¶ï¼Œæ‹¬å·å†…å¼å­å¿…é¡»ä¸ºé›¶ï¼Œè€Œå®ƒä»¬æ­£æ˜¯æ”¯æŒå‘é‡ã€‚å¯¹äºè½¯é—´éš”çš„æ”¯æŒå‘é‡ï¼š</p>

<ul>
  <li>
    <p>è‹¥ $\alpha^{\ast}_i &lt; C$ ï¼Œåˆ™ $\zeta_i = 0$ ï¼Œæ”¯æŒå‘é‡æ­£å¥½åœ¨é—´éš”è¾¹ç•Œä¸Š</p>

    <p>$\because$ KKT æ¡ä»¶æœ‰ï¼š$\mu_i^{\ast} \zeta_i^{\ast} = 0$</p>

    <p>åˆçº¦æŸæ¡ä»¶ï¼š $C - \alpha_i - \mu_i = 0$</p>

    <p>$\therefore$ å½“ $\alpha_i &lt; C$ æ—¶ï¼Œ$\mu_i \neq 0 \Rightarrow \zeta_i = 0$</p>
  </li>
  <li>
    <p>è‹¥ $\alpha_i^{\ast} = C$</p>

    <ul>
      <li>
        <p>$0 &lt; \zeta_i &lt; 1$ï¼šåˆ†ç±»æ­£ç¡®ï¼Œæ ·æœ¬ç‚¹åœ¨é—´éš”è¾¹ç•Œå’Œåˆ†ç¦»è¶…å¹³é¢ä¹‹é—´</p>
      </li>
      <li>
        <p>$\zeta_i = 1$ï¼šæ ·æœ¬ç‚¹åœ¨åˆ†ç¦»è¶…å¹³é¢ä¸Š</p>
      </li>
      <li>
        <p>$\zeta_i &gt; 1$ï¼šæ ·æœ¬ç‚¹åœ¨åˆ†ç¦»è¶…å¹³é¢è¯¯åˆ†ä¸€ä¾§</p>
      </li>
    </ul>

    <blockquote>
      <p>$\because \alpha_i = C$ï¼Œ $C- \alpha_i - \mu_i = 0$</p>

      <p>$\therefore\mu_i = 0$</p>

      <p>$\because \mu_i \zeta_i = 0$</p>

      <p>$\therefore\zeta_i &gt; 0$ æˆ–è€… $\zeta_i = 0$ï¼ˆè¿™é‡Œ $\zeta_i = 0$ ä¸å†è®¨è®ºï¼‰</p>
    </blockquote>
  </li>
</ul>

<h2 id="3-åºåˆ—æœ€å°æœ€ä¼˜åŒ–ç®—æ³•-smo">3 åºåˆ—æœ€å°æœ€ä¼˜åŒ–ç®—æ³• SMO</h2>

<p>SMO ç®—æ³•è¦è§£å¦‚ä¸‹å‡¸äºŒæ¬¡è§„åˆ’çš„å¯¹å¶é—®é¢˜ï¼š</p>

<script type="math/tex; mode=display">\mathop{\arg\min}\limits_{\alpha} \left\{ \dfrac{1}{2} \sum\limits_{i=1}^{N} \sum\limits_{j=1}^{N} \alpha_i \alpha_j y_iy_j K(x_i, x_j) - \sum\limits_{i=1}^{N} \alpha_i \right\} \tag{3.1}</script>

<p>s.t.</p>

<script type="math/tex; mode=display">\sum\limits_{i=1}^{N} a_iy_i =0 \tag{3.2}</script>

<script type="math/tex; mode=display">0 \le \alpha_i \le C \tag{3.3}</script>

<p>è¿™ä¸ªé—®é¢˜ä¸­çš„å˜é‡æ˜¯æ‹‰æ ¼æœ—æ—¥ä¹˜å­ï¼Œä¸€ä¸ªå˜é‡ $\alpha_i$ å¯¹åº”ä¸€ä¸ªæ ·æœ¬ç‚¹</p>

<p>SMO çš„æ€æƒ³æ˜¯ï¼šå¦‚æœæ‰€æœ‰å˜é‡çš„è§£éƒ½æ»¡è¶³ KKT æ¡ä»¶ï¼Œé‚£ä¹ˆæœ€ä¼˜è§£å°±æ‰¾åˆ°äº†ï¼›å¦åˆ™ï¼Œæ¯æ¬¡å–å‡ºä¸¤ä¸ªå˜é‡ï¼Œå›ºå®šå…¶ä»–å˜é‡ï¼Œæ±‚è¿™ä¸¤ä¸ªå˜é‡çš„äºŒæ¬¡è§„åˆ’é—®é¢˜çš„è§£ã€‚</p>

<p>SMO ç®—æ³•åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€ä¸ªæ˜¯æ±‚è§£äºŒæ¬¡è§„åˆ’é—®é¢˜è§£ææ–¹æ³•ï¼Œå¦ä¸€ä¸ªæ˜¯é€‰æ‹©ä¸¤ä¸ªå˜é‡çš„å¯å‘å¼æ–¹æ³•ã€‚</p>

<h3 id="31-æ±‚è§£ä¸¤ä¸ªå˜é‡äºŒæ¬¡è§„åˆ’é—®é¢˜çš„è§£ææ–¹æ³•">3.1 æ±‚è§£ä¸¤ä¸ªå˜é‡äºŒæ¬¡è§„åˆ’é—®é¢˜çš„è§£ææ–¹æ³•</h3>

<p>æœ€ä¼˜åŒ–é—®é¢˜çš„æœªå‰ªè¾‘è§£ä¸ºï¼š</p>

<script type="math/tex; mode=display">\alpha_2^{new, unc} = \alpha_2^{old} + \dfrac{y_2(E_1 - E_2)}{\eta} \tag{3.4}</script>

<p>å…¶ä¸­ï¼š</p>

<script type="math/tex; mode=display">\eta = K_{11} + K_{22} - 2 K_{12}</script>

<script type="math/tex; mode=display">K11 = x_1 \cdot x_2</script>

<script type="math/tex; mode=display">E_i = g(x_i) - y_i</script>

<script type="math/tex; mode=display">g(x_i) = \sum\limits_{j=1}^{N} a_j y_j K(x_j, x_i) + b</script>

<p>ç»è¿‡å‰ªè¾‘åçš„è§£</p>

<script type="math/tex; mode=display">\alpha_2^{new} = clip(\alpha_2^{new, unc}, L, H) \tag{3.5}</script>

<script type="math/tex; mode=display">\alpha_1^{new} = \alpha_1^{old} + y_1y_2 (\alpha_2^{old} - \alpha_2^{new}) \tag{3.6}</script>

<blockquote>
  <p>å…¶ä¸­ï¼š</p>
  <ul>
    <li>
      <p>$y_1 = y_2$ï¼š</p>

      <script type="math/tex; mode=display">L = \max(0, \alpha_2^{old} - \alpha_1^{old}), \quad H = \min(C, C + \alpha_2^{old} - \alpha_1^{old})</script>
    </li>
    <li>
      <p>$y_1 \neq y_2$ï¼š</p>

      <script type="math/tex; mode=display">L = \max(0, \alpha_2^{old} + \alpha_1^{old}-C), \quad H = \min(C, \alpha_2^{old} + \alpha_1^{old})</script>
    </li>
  </ul>
</blockquote>

<h3 id="32-å˜é‡çš„é€‰æ‹©">3.2 å˜é‡çš„é€‰æ‹©</h3>

<ol>
  <li>
    <p>ç¬¬ 1 ä¸ªå˜é‡çš„é€‰æ‹©</p>

    <p>éå†æ‰€æœ‰æ ·æœ¬ï¼Œé€‰æ‹©æœ€è¿èƒŒ KKT æ¡ä»¶çš„æ ·æœ¬ï¼Œé€‰æ‹©å®ƒå¯¹åº”çš„å‚æ•° $\alpha_i$ ä¸ºç¬¬ä¸€ä¸ªå˜é‡ã€‚æ ·æœ¬çš„ KKT æ¡ä»¶ä¸å‚æ•°çš„å…³ç³»ï¼š</p>

    <script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}  \alpha_i = 0 &\iff& y_i g(x_i) \ge 1 \\ 0 < \alpha_i < C &\iff& y_i g(x_i) = 1 \\ \alpha_i = C &\iff& y_i g(x_i) \le 1 \end{aligned} %]]></script>

    <p>å…ˆæ£€æŸ¥é—´éš”è¾¹ç•Œä¸Šçš„æ ·æœ¬ç‚¹ï¼Œå¦‚æœå®ƒä»¬æ»¡è¶³åœ¨æ£€æŸ¥å…¶ä»–æ ·æœ¬ç‚¹</p>
  </li>
  <li>
    <p>ç¬¬ 2 ä¸ªå˜é‡çš„é€‰æ‹©</p>

    <p>ç¬¬ 2 ä¸ªå˜é‡çš„é€‰æ‹©å¸Œæœ›èƒ½ä½¿ $\alpha_2$ æœ‰è¶³å¤Ÿå¤§çš„å˜åŒ–ã€‚åˆå› ä¸º $\alpha_2^{new}$ ä¾èµ–äº $| E_1 - E_2 |$ï¼Œæ‰€ä»¥é€‰æ‹©ä½¿å…¶æœ€å¤§çš„ $\alpha_2$</p>
  </li>
</ol>

<h3 id="33-è®¡ç®—é˜ˆå€¼-b-å’Œå·®å€¼-e_1">3.3 è®¡ç®—é˜ˆå€¼ b å’Œå·®å€¼ $E_1$</h3>

<h4 id="331-æ›´æ–°-b-å€¼">3.3.1 æ›´æ–° b å€¼</h4>
<p>å®Œæˆä¸¤ä¸ªå˜é‡çš„ä¼˜åŒ–ä¹‹åï¼Œè¦é‡æ–°è®¡ç®— bã€‚</p>

<p>å½“ $0 &lt; \alpha_1^{new} &lt; C$ æ—¶ï¼š</p>

<script type="math/tex; mode=display">b_1^{new} = -E_1 - y_1 K_{11} (\alpha_1^{new} - \alpha_1^{old}) - y_2 K_{21} (\alpha_2^{new} - \alpha_2^{old}) + b^{old} \tag{3.6}</script>

<p>åŒæ ·çš„ï¼Œå¦‚æœ $0 &lt; \alpha_2^{new} &lt; C$ï¼Œé‚£ä¹ˆï¼š</p>

<script type="math/tex; mode=display">b_2^{new} = -E_2 - y_1 K_{12} (\alpha_1^{new} - \alpha_1^{old}) - y_2 K_{22} (\alpha_2^{new} - \alpha_2^{old}) + b^{old} \tag{3.7}</script>

<ol>
  <li>
    <p>å¦‚æœ $\alpha_1, \alpha_2$ åŒæ—¶æ»¡è¶³æ¡ä»¶[0, C]ï¼Œé‚£ä¹ˆ $b_1^{new} = b_2^{new}$</p>
  </li>
  <li>
    <p>å¦‚æœ $\alpha_1^{new}, \alpha_2^{new}$ æ˜¯ 0 æˆ– cï¼Œé‚£ä¹ˆé€‰æ‹©ä¸­ç‚¹ä½œä¸º $b^{new}$</p>
  </li>
</ol>

<h4 id="332-æ›´æ–°-e_1">3.3.2 æ›´æ–° $E_1$</h4>

<script type="math/tex; mode=display">E_i^{new} = \sum\limits_{s} y_j \alpha_j K(x_i, x_j) + b^{new} - y_i</script>

<p>å…¶ä¸­ $S$ æ˜¯æ‰€æœ‰æ”¯æŒå‘é‡ $x_j$ çš„é›†åˆã€‚</p>

<h3 id="34-smo-ç®—æ³•æµç¨‹">3.4 SMO ç®—æ³•æµç¨‹</h3>

<ul>
  <li>
    <p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ® $D = \lbrace (x_1, y_1), (x_2, y_2), \dots, (x_N, y_N) \rbrace$</p>
  </li>
  <li>
    <p>è¾“å‡ºï¼šè¿‘ä¼¼è§£ $\hat{\alpha}$</p>
  </li>
  <li>
    <p>è¿‡ç¨‹ï¼š</p>

    <ol>
      <li>
        <p>å–åˆå€¼ $\alpha^{(0)} = 0$ï¼Œä»¤ $k = 0$</p>
      </li>
      <li>
        <p>é€‰å–ä¼˜åŒ–å˜é‡ $a_1^{(k)}, a_2^{(k)}$ ï¼Œè§£æä¸¤ä¸ªå˜é‡çš„æœ€ä¼˜åŒ–é—®é¢˜ï¼Œå¾—åˆ°æœ€ä¼˜è§£ $a_1^{(k+1)}, a_2^{(k+2)}$ ï¼Œæ›´æ–° $\alpha = \alpha^{(k+1)}$</p>
      </li>
      <li>
        <p>è‹¥åœ¨ç²¾åº¦ $\sigma$ èŒƒå›´å†…æ»¡è¶³åœæœºæ¡ä»¶åˆ™è½¬(4)ï¼›å¦åˆ™ä»¤ $k = k+1$ ï¼Œè½¬(2)</p>

        <ul>
          <li>
            <p>$\sum\limits_{i=1}^{N} \alpha_i y_i = 0$</p>
          </li>
          <li>
            <p>$0 \le \alpha_i \le C$</p>
          </li>
          <li>
            <p>$y_i \cdot g(x_i) = \begin{cases} \ge 1, &amp; \left\lbrace x_i \mid \alpha_i = 0 \right\rbrace \ = 1, &amp; \left\lbrace x_i \mid 0 &lt; \alpha_i &lt; C \right\rbrace \ \le 1, &amp; \left\lbrace x_i \mid \alpha_i = C \right\rbrace \end{cases}$ï¼Œå…¶ä¸­ï¼š $g(x_i) = \sum\limits_{j=1}^{N} a_j y_j K(x_j, x_i) + b$</p>
          </li>
        </ul>
      </li>
      <li>
        <p>å– $\hat{\alpha} = \alpha^{(k+1)}$</p>
      </li>
    </ol>
  </li>
</ul>

<h2 id="4-ä»£ç å®æˆ˜">4 ä»£ç å®æˆ˜</h2>

<h3 id="41-ç®€å•-svm-ç®—æ³•æ€è·¯">4.1 ç®€å• SVM ç®—æ³•æ€è·¯</h3>

<p>å½“æ‹¿åˆ°æ•°æ®æ—¶ï¼Œæˆ‘ä»¬çŸ¥é“ä»»åŠ¡æ˜¯æ‰¾åˆ°ä¸€ä¸ªåˆ†ç¦»è¶…å¹³é¢ $(w^\ast, b^\ast)$ï¼ŒæŠŠæ•°æ®åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œè€Œè¿™ä¸ªè¶…å¹³é¢æ˜¯ç”±å‚æ•° $\color{red}{\boldsymbol{\alpha}}$ å†³å®šã€‚ç®€å• SVM ç®—æ³•çš„æ€è·¯æ˜¯ï¼š</p>

<ol>
  <li>
    <p>ç»™æ¯ä¸ªæ ·æœ¬ $(x_k, y_k)$ è®¾ç½®ä¸€ä¸ªå‚æ•° $\alpha_k$</p>
  </li>
  <li>
    <p>é€‰æ‹©å‚æ•° $\alpha_i, \alpha_j$ è¿›è¡Œä¼˜åŒ–ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>

    <ol>
      <li>
        <p>é€‰æ‹©è¦ä¼˜åŒ–çš„ $\alpha_i$</p>

        <p>é€‰æ‹©æ ‡å‡†ï¼šå½“æ­¤æ ·æœ¬çš„é¢„æµ‹è¯¯å·®å¾ˆå¤§æ—¶ï¼Œåˆ™ä¼˜åŒ–</p>

        <ul>
          <li>
            <p>$y_i E_i &gt; tol, \alpha_i &gt; 0$</p>

            <p>å½“åˆ†ç±»æ­£ç¡®æ—¶ï¼Œ$\alpha_i$ ä¼šè¢«è°ƒæ•´å°ï¼Œé‚£ä¹ˆå½“è¿™ä¸ª $\alpha_i$ å·²ç»åœ¨ 0 ä¸Šæ—¶ï¼Œä¸éœ€è¦åœ¨è°ƒæ•´äº†ï¼Œå› ä¸ºå®ƒçš„èŒƒå›´æ˜¯ [0, C]</p>
          </li>
          <li>
            <p>$y_i E_i &lt; - tol, \alpha_i &lt; C$</p>

            <p>å½“åˆ†ç±»é”™è¯¯æ—¶ï¼Œ$\alpha_i$ ä¼šè¢«è°ƒæ•´å¤§ï¼Œé‚£ä¹ˆå½“è¿™ä¸ª $\alpha_i$ å·²ç»åœ¨ C ä¸Šæ—¶ï¼Œä¸éœ€è¦åœ¨è°ƒæ•´äº†ï¼Œå› ä¸ºå®ƒçš„èŒƒå›´æ˜¯ [0, C]</p>
          </li>
        </ul>

        <p>å…¶ä¸­ï¼š</p>

        <p>$E_i = g(x_i) - y_i$</p>

        <p>$g(x_i) = \sum\limits_{j=1}^{N} a_j y_j K(x_j, x_i) + b$</p>
      </li>
      <li>
        <p>éšæœºé€‰æ‹©å¦ä¸€ä¸ªå‚æ•° $\alpha_j (\neq \alpha_i)$</p>
      </li>
      <li>
        <p>æ›´æ–° $\alpha_i, \alpha_j$</p>

        <ul>
          <li>
            <p>$\alpha_j^{new, unc} = \alpha_j^{old} + \dfrac{y_j(E_i - E_j)}{\eta}$</p>
          </li>
          <li>
            <p>$\alpha_j^{new} = clip(\alpha_j^{new, unc}, L, H)$</p>

            <p>å¦‚æœ $\mid \alpha_j^{new} - \alpha_j^{old} \mid &lt; \epsilon$ ï¼Œé‡æ–°é€‰æ‹© $\alpha_i, \alpha_j$ï¼Œå¦åˆ™ï¼š</p>
          </li>
          <li>
            <p>$\alpha_i^{new} = \alpha_i^{old} + y_iy_j (\alpha_j^{old} - \alpha_j^{new})$</p>
          </li>
        </ul>
      </li>
    </ol>
  </li>
  <li>
    <p>æ›´æ–° $b$</p>

    <p>å½“ $0 \lt \alpha_i^{new} &lt; C$ æ—¶ï¼š</p>

    <p>$b_i^{new} = - E_i - y_i K_{ii} (\alpha_i^{new} - \alpha_i^{old}) - y_j K_{ji} (\alpha_j^{new} - \alpha_j^{old}) + b^{old}$</p>

    <p>$b_j^{new} = - E_j - y_i K_{ij} (\alpha_i^{new} - \alpha_i^{old}) - y_j K_{jj} (\alpha_j^{new} - \alpha_j^{old}) + b^{old}$</p>

    <ul>
      <li>
        <p>å¦‚æœ $\alpha_i^{new}, \alpha_j^{new}$ åŒæ—¶æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ $b_i^{new} = b_j^{new}$</p>
      </li>
      <li>
        <p>å¦‚æœ $\alpha_i^{new}, \alpha_j^{new}$ éƒ½æ˜¯ 0 æˆ– Cï¼Œé€‰æ‹©å®ƒä»¬çš„ä¸­ç‚¹ä½œä¸º $b^{new}$</p>
      </li>
    </ul>
  </li>
  <li>
    <p>æ›´æ–° $E_i$ å€¼ï¼š</p>

    <script type="math/tex; mode=display">E_i^{new} = \sum\limits_{s} y_i \alpha_i K(x_i, x_j) + b^{new} - y_i</script>

    <blockquote>
      <p>S æ˜¯æ‰€æœ‰æ”¯æŒå‘é‡ $x_j$ çš„åˆé›†</p>
    </blockquote>
  </li>
  <li>
    <p>è¿­ä»£è®¾å®šæ¬¡æ•°åï¼Œå®Œæˆ</p>
  </li>
</ol>

<h3 id="42-ä»£ç å®æˆ˜">4.2 ä»£ç å®æˆ˜</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">def</span> <span class="nf">simple_svm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">nsamples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nsamples</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,))</span>
    <span class="n">iter_num</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">iter_num</span> <span class="o">&lt;</span> <span class="n">max_iter</span><span class="p">:</span>
        <span class="n">alpha_pairs_renew</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsamples</span><span class="p">):</span>
            <span class="n">gxi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
            <span class="n">Ei</span> <span class="o">=</span> <span class="n">gxi</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">Ei</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">epsilon</span> <span class="ow">and</span> <span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">Ei</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">epsilon</span> <span class="ow">and</span> <span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">C</span><span class="p">):</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">selectJ</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">)</span>
                <span class="n">gxj</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
                <span class="n">Ej</span> <span class="o">=</span> <span class="n">gxj</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

                <span class="n">ai_old</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">aj_old</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">eta</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">"&gt;&gt;&gt; eta &lt;= 0"</span><span class="p">);</span> <span class="k">continue</span>

                <span class="k">if</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">aj_old</span> <span class="o">-</span> <span class="n">ai_old</span><span class="p">)</span>
                    <span class="n">H</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">C</span> <span class="o">+</span> <span class="n">aj_old</span> <span class="o">-</span> <span class="n">ai_old</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">L</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">aj_old</span> <span class="o">+</span> <span class="n">ai_old</span> <span class="o">-</span> <span class="n">C</span><span class="p">)</span>
                    <span class="n">H</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">aj_old</span> <span class="o">+</span> <span class="n">ai_old</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">L</span> <span class="o">==</span> <span class="n">H</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">"&gt;&gt;&gt; L == H"</span><span class="p">);</span> <span class="k">continue</span>

                <span class="n">alpha</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">aj_old</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ei</span> <span class="o">-</span> <span class="n">Ej</span><span class="p">)</span> <span class="o">/</span> <span class="n">eta</span>
                <span class="n">alpha</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">clip</span><span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">L</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">aj_old</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.00001</span><span class="p">):</span>
                    <span class="c1">#print("&gt;&gt;&gt; alpha[j] çš„æ”¹å˜å¤ªå°"); 
</span>                    <span class="k">continue</span>
                <span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ai_old</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">aj_old</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

                <span class="n">K11</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">K12</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="n">K21</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">K22</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="n">bi</span><span class="o">=</span> <span class="o">-</span><span class="n">Ei</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">K11</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ai_old</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">K21</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">aj_old</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
                <span class="n">bj</span><span class="o">=</span> <span class="o">-</span><span class="n">Ej</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">K12</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ai_old</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">K22</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">aj_old</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">C</span><span class="p">:</span> <span class="n">b</span> <span class="o">=</span> <span class="n">bi</span>
                <span class="k">elif</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">C</span><span class="p">:</span> <span class="n">b</span> <span class="o">=</span> <span class="n">bj</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">bi</span> <span class="o">+</span> <span class="n">bj</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
                <span class="n">alpha_pairs_renew</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"ç¬¬[{}]æ¬¡è¿­ä»£ï¼Œç¬¬[{}]æ ·æœ¬ï¼Œç¬¬[{}]æ¬¡æ›´æ–°"</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">iter_num</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">alpha_pairs_renew</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">alpha_pairs_renew</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">iter_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">iter_num</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">b</span>


<span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="n">H</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">H</span>
    <span class="k">elif</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">L</span>
    <span class="k">return</span> <span class="n">num</span>


<span class="k">def</span> <span class="nf">selectJ</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">idx</span>
    <span class="k">while</span> <span class="n">j</span> <span class="o">==</span> <span class="n">idx</span><span class="p">:</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">j</span>


<span class="k">def</span> <span class="nf">load_dataset</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">curdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">curdir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">fr</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fr</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_w</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">labels</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">show_classifier</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">X_plus</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">X_minus</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">X_plus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_minus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x_plus_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_plus</span><span class="p">)</span>
    <span class="n">x_minus_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_minus</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_plus_np</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">x_plus_np</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_minus_np</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">x_minus_np</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="n">w</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
    <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="n">a1</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="n">a2</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="n">a1</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span> <span class="o">/</span> <span class="n">a2</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'none'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s">'red'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s">'svm_dataset.txt'</span><span class="p">)</span>
    <span class="n">alpha</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">simple_svm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">get_w</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="n">show_classifier</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="43-æ‰§è¡Œç»“æœ">4.3 æ‰§è¡Œç»“æœ</h3>

<p><img src="/assets/images/posts/2019-09-17-schap7.svm/simple.jpeg" alt="simple" /></p>

<h3 id="44-ä¼˜åŒ–çš„-smo-ç®—æ³•">4.4 ä¼˜åŒ–çš„ SMO ç®—æ³•</h3>

<ol>
  <li>
    <p>å½“è¿­ä»£æ¬¡æ•°è¶…è¿‡æœ€å¤§å€¼ï¼Œå¹¶ä¸”éå†æ•´ä¸ªé›†åˆéƒ½æ²¡æœ‰å¯¹ä»»æ„ $\alpha$ è¿›è¡Œä¿®æ”¹æ—¶ï¼Œé€€å‡ºå¾ªç¯</p>

    <ul>
      <li>
        <p>å¦‚æœæ˜¯å…¨æ–°æ•°æ®é›†ï¼š</p>

        <p>å¾ªåºé€‰æ‹© $\alpha_i$ï¼Œå†ä¼˜åŒ– $\alpha_i, \alpha_j$</p>
      </li>
      <li>
        <p>å¦åˆ™ï¼š</p>

        <p>æ‰¾åˆ° $0 \lt \alpha_i \lt C$ çš„ $\alpha_i$ ï¼Œå†ä¼˜åŒ– $\alpha_i, \alpha_j$</p>
      </li>
    </ul>
  </li>
</ol>

<h3 id="45-å®æˆ˜ä»£ç ">4.5 å®æˆ˜ä»£ç </h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>


<span class="k">def</span> <span class="nf">load_dataset</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">curdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">curdir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">fr</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fr</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="n">H</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">H</span>
    <span class="k">elif</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">L</span>
    <span class="k">return</span> <span class="n">num</span>


<span class="k">def</span> <span class="nf">selectJrand</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">idx</span>
    <span class="k">while</span> <span class="n">j</span> <span class="o">==</span> <span class="n">idx</span><span class="p">:</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">j</span>


<span class="k">def</span> <span class="nf">get_w</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">labels</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">opt_struct</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">toler</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tol</span> <span class="o">=</span> <span class="n">toler</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_cache</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">update_ek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="n">ek</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">calc_ek</span><span class="p">(</span><span class="n">os</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">e_cache</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ek</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">calc_ek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="s">'''
        fxk = sum_i(ai * yi * K(X, X[k])) + b
        '''</span>
        <span class="n">fxk</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">a</span> <span class="o">*</span> <span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">b</span>
        <span class="n">ek</span> <span class="o">=</span> <span class="n">fxk</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ek</span>

    <span class="k">def</span> <span class="nf">selectJ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">ei</span><span class="p">):</span>
        <span class="s">'''
        1. æ‰¾åˆ° e_cache ä¸­çš„éé›¶é¡¹
        2. å¦‚æœéé›¶é¡¹æ²¡æœ‰ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ª jï¼Œè®¡ç®— ej
        3. å¦åˆ™ï¼Œå¯¹äºæ¯ä¸€ä¸ªéé›¶é¡¹k
            3.1 k != i
            3.2 è®¡ç®—è¯¯å·® ek = calc_ek(os, k)
            3.2 è®¡ç®—ä¸eiç›¸å·®æœ€å¤§çš„ek
        4. è¿”å›å¯¹åº”çš„ k å’Œ ek

        '''</span>
        <span class="n">max_k</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">max_delta_e</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ej</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">os</span><span class="o">.</span><span class="n">e_cache</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">ei</span><span class="p">]</span>
        <span class="n">vaild_ecache_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">e_cache</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vaild_ecache_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vaild_ecache_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span> <span class="k">continue</span>
                <span class="n">ek</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">calc_ek</span><span class="p">(</span><span class="n">os</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                <span class="n">delta_e</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ei</span> <span class="o">-</span> <span class="n">ek</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">delta_e</span> <span class="o">&gt;</span> <span class="n">max_delta_e</span><span class="p">):</span>
                    <span class="n">max_k</span> <span class="o">=</span> <span class="n">k</span>
                    <span class="n">max_delta_e</span> <span class="o">=</span> <span class="n">delta_e</span>
                    <span class="n">ej</span> <span class="o">=</span> <span class="n">ek</span>
            <span class="k">return</span> <span class="n">max_k</span><span class="p">,</span> <span class="n">ej</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">selectJrand</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
            <span class="n">ej</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">calc_ek</span><span class="p">(</span><span class="n">os</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">j</span><span class="p">,</span> <span class="n">ej</span>


<span class="k">def</span> <span class="nf">innerL</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">os</span><span class="p">):</span>
    <span class="s">'''
    1. è®¡ç®—æ ·æœ¬ i çš„è¯¯å·®
    2. å¦‚æœè¯¯å·®è¶³å¤Ÿå¤§ï¼Œè€Œä¸”ä¸åœ¨è¾¹ç•Œä¸Šï¼š
        2.1 é€‰æ‹© aj
        2.2 æ ¹æ® ai ?= ajï¼Œè®¡ç®— L, H
        2.3 è®¡ç®— eta (&lt; 0)
        2.4 è®¡ç®— aj = aj - yj*(ei - ej)/eta, aj = clip(aj, L, H)
        2.5 æŠŠ aj æ›´æ–°è‡³ e_cache
        2.6 è®¡ç®— ai = ai + yj*yi*(aj_old - aj)
        2.7 æŠŠ ai æ›´æ–°è‡³ e_cache
        2.8 è®¡ç®—
            b1 = -b - ei - yi(ai - ai_old) * k11 - yj(aj - aj_old) * k12
            b2 = -b - ej - yi(ai - ai_old) * k12 - yj(aj - aj_old) * k12
            å¦‚æœ 0 &lt; ai &lt; Cï¼šb = b1
            å¦‚æœ 0 &lt; aj &lt; Cï¼šb = b2
            å¦åˆ™ï¼š b = (b1 + b2) / 2
    3. å¦åˆ™ï¼š
        è¿”å› 0

    '''</span>
    <span class="n">ei</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">calc_ek</span><span class="p">(</span><span class="n">os</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">ei</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">os</span><span class="o">.</span><span class="n">tol</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">os</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> <span class="ow">or</span> \
            <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">ei</span> <span class="o">&gt;</span> <span class="n">os</span><span class="o">.</span><span class="n">tol</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">j</span><span class="p">,</span> <span class="n">ej</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">selectJ</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">ei</span><span class="p">)</span>
        <span class="n">ai_old</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">aj_old</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span>
            <span class="n">L</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">H</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">c</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">L</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
            <span class="n">H</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">L</span> <span class="o">==</span> <span class="n">H</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">"L == H"</span><span class="p">);</span><span class="k">return</span> <span class="mi">0</span>
        <span class="n">eta</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span> <span class="o">-</span> \
                <span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])</span>
        <span class="k">if</span> <span class="n">eta</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">"Eta &gt;= 0"</span><span class="p">);</span> <span class="k">return</span> <span class="mi">0</span>
        <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">ei</span> <span class="o">-</span> <span class="n">ej</span><span class="p">)</span> <span class="o">/</span> <span class="n">eta</span>
        <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">clip</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">L</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">update_ek</span><span class="p">(</span><span class="n">os</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">aj_old</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.00001</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"aj å˜åŒ–å¤ªå°"</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">aj_old</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">os</span><span class="o">.</span><span class="n">update_ek</span><span class="p">(</span><span class="n">os</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

        <span class="n">k11</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">k12</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">k21</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">k22</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])</span>

        <span class="n">b1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">b</span> <span class="o">-</span> <span class="n">ei</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ai_old</span><span class="p">)</span> <span class="o">*</span> <span class="n">k11</span> <span class="o">-</span> \
                <span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">aj_old</span><span class="p">)</span> <span class="o">*</span> <span class="n">k21</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">b</span> <span class="o">-</span> <span class="n">ej</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ai_old</span><span class="p">)</span> <span class="o">*</span> <span class="n">k12</span> <span class="o">-</span> \
                <span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">aj_old</span><span class="p">)</span> <span class="o">*</span> <span class="n">k22</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">os</span><span class="o">.</span><span class="n">c</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b1</span>
        <span class="k">elif</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">os</span><span class="o">.</span><span class="n">c</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b2</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">b1</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>


<span class="k">def</span> <span class="nf">show_classifier</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">X_plus</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">X_minus</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">X_plus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_minus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x_plus_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_plus</span><span class="p">)</span>
    <span class="n">x_minus_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_minus</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_plus_np</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">x_plus_np</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_minus_np</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">x_minus_np</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="n">w</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
    <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="n">a1</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="n">a2</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="n">a1</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span> <span class="o">/</span> <span class="n">a2</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'none'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s">'red'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">opt_smo</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">toler</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">,</span> <span class="n">ktup</span><span class="o">=</span><span class="p">(</span><span class="s">'lin'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
    <span class="s">'''
    1. å½“è¿­ä»£æ¬¡æ•° &lt; æœ€å¤§å€¼ï¼Œå¹¶ä¸”(æœ‰ä¼˜åŒ–çš„ a æˆ–è€…æ˜¯æ–°é›†åˆ)
        1.1 å¦‚æœæ˜¯æ–°é›†åˆï¼š
            æŠ½å–é›†åˆä¸­çš„æ¯ä¸€ä¸ªæ ·æœ¬
            ä¼˜åŒ– ai, aj
        1.2 å¦åˆ™ï¼š
            æ‰¾å‡º a çš„éè¾¹ç•Œé›†åˆ
            å¯¹äºéè¾¹ç•Œé›†åˆä¸­çš„æ¯ä¸€ä¸ª aï¼š
                ä¼˜åŒ– ai, aj
    2. è¿”å› a, b å€¼
    '''</span>
    <span class="n">os</span> <span class="o">=</span> <span class="n">opt_struct</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">toler</span><span class="p">)</span>
    <span class="nb">iter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">entire_set</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">achanged</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nb">iter</span> <span class="o">&lt;</span> <span class="n">max_iter</span> <span class="ow">and</span> <span class="p">(</span><span class="n">achanged</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">entire_set</span><span class="p">):</span>
        <span class="n">achanged</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">entire_set</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">m</span><span class="p">):</span>
                <span class="n">achanged</span> <span class="o">+=</span> <span class="n">innerL</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">os</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"å…¨é›†ï¼Œè¿­ä»£ï¼š</span><span class="si">%</span><span class="s">d i:</span><span class="si">%</span><span class="s">d æˆå¯¹ä¿®æ”¹ï¼š</span><span class="si">%</span><span class="s">d"</span> <span class="o">%</span> <span class="p">(</span><span class="nb">iter</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">achanged</span><span class="p">))</span>
                <span class="nb">iter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">non_bound_is</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">((</span><span class="n">os</span><span class="o">.</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">C</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">non_bound_is</span><span class="p">:</span>
                <span class="n">achanged</span> <span class="o">+=</span> <span class="n">innerL</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">os</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"non-bound, iter: </span><span class="si">%</span><span class="s">d, i:</span><span class="si">%</span><span class="s">d, æˆå¯¹ä¿®æ”¹ï¼š</span><span class="si">%</span><span class="s">d"</span> <span class="o">%</span> \
                        <span class="p">(</span><span class="nb">iter</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">achanged</span><span class="p">))</span>
                <span class="nb">iter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">entire_set</span><span class="p">:</span> <span class="n">entire_set</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">elif</span> <span class="n">achanged</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">entire_set</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"iter number:"</span><span class="p">,</span> <span class="nb">iter</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">b</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s">'svm_dataset.txt'</span><span class="p">)</span>
    <span class="n">alpha</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">opt_smo</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">get_w</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="n">show_classifier</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="46-æ‰§è¡Œç»“æœ">4.6 æ‰§è¡Œç»“æœ</h3>

<p><img src="/assets/images/posts/2019-09-17-schap7.svm/opt.jpeg" alt="opt" /></p>
:ET